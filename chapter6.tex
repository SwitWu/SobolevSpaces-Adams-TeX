\setcounter{chapter}{5}
\chapter{Compact Imbeddings of Sobolev Spaces}

\section{The Rellich-Kondrachov Theorem}

\begin{para}[Restricted Imbeddings]
  Let $\Omega$ be a domain in $\mathbb{R}^n$ and let $\Omega_0$ be a sundomain of $\Omega$.
  Let $X(\Omega)$ denote any of the possible target spaces for imbeddings of $W^{m,p}(\Omega)$, that is,
  $X(\Omega)$ is a space of the form $C_B^j(\Omega)$, $C^j(\overline{\Omega})$,
  $C^{j,\lambda}(\overline{\Omega})$, $L^q(\Omega_k)$, or $W^{j,q}(\Omega_k)$, where $\Omega_k$, $1\leq k\leq n$,
  is the intersection of $\Omega$ with a $k$-dimensional plane in $\mathbb{R}^n$. Since the linear restriction 
  operator $i_{\Omega_0}: u\to u|_{\Omega_0}$ is bounded from $X(\Omega)$ into $X(\Omega_0)$
  (in fact $\|i_{\Omega_0}u\|_{X(\Omega_0)} \leq \|u\|_{X(\Omega)}$) any imbeddings of the form
  \begin{equation}\label{eq:6.1}
    W^{m,p}(\Omega) \to X(\Omega)
  \end{equation}
  can be composed with this restriction to yield the imbedding
  \begin{equation}\label{eq:6.2}
    W^{m,p}(\Omega) \to X(\Omega_0)
  \end{equation}
  and \eqref{eq:6.2} has imbedding constant no larger than \eqref{eq:6.1}.
\end{para}


\begin{para}[Compact Imbeddings]
  Recall that a set $A$ in a normed space is precompact if every sequence of points in $A$ has a subsequence
  converging in norm to an element of the space. An operator between normed spaces is called compact if it
  maps bounded sets into precompact sets, and is called completely continuous if it is continuous and compact.
  (See Paragraph~1.24; for linear operators compactness and complete continuity are equivalent.)
  In this chapter we are concerned with the compactness of imbedding operators which are continuous whenever
  they exist, and so are completely continuous whenever they are compact.

  If $\Omega$ satisfies the hypothesis of the Sobolev imbedding Theorem~4.12 and if $\Omega_0$ is a bounded
  subset of $\Omega$, then, with the exception of certain extreme cases, all the restricted
  imbeddings \eqref{eq:6.1} corresponding to imbeddings asserted in Theorem~4.12 are compact.
  The most important of these compact imbedding results originated in a lemma of Rellich [Re] and was proved
  specifically for Sobolev spaces by Kondrachov [K]. Such compact imbeddings have many important applications
  in analysis, especially to showing that linear elliptic partial differential equations defined over
  bounded domains have discrete spectra. See, for example, [EE] and [ET] for such applications and further
  refinements.
\end{para}

We summarize the various compact imbeddings of $W^{m,p}(\Omega)$ in the following theorem

\begin{theorem}[The Rellich-Kondrachov Theorem]
  Let $\Omega$ be a domain in $\mathbb{R}^n$, let $\Omega_0$ be a bounded subdomain of $\Omega$, and let
  $\Omega_0^k$ be the intersection of $\Omega_0$ with a $k$-dimensional plane in $\mathbb{R}^n$.
  Let $j\geq 0$ and $m\geq 1$ be integers, and let $1\leq p<\infty$.
  \begin{enumerate}[label = \textbf{PART \Roman*},
                    labelindent = 0pt,
                    labelsep = 5pt,
                    leftmargin = 0pt,
                    labelwidth = 3em,
                    itemindent = *,
                    align = left]
    \item If $\Omega$ satisfies the cone condition and $mp<n$, then the following imbeddings are compact:
      \begin{align}
        & W^{j+m,p}(\Omega) \to W^{j,q}(\Omega_0^k) & & \text{if } 0 < n-mp < k \leq n \text{ and } 
          1\leq q < kp/(n-mp), \label{eq:6.3} \\
        & W^{j+m,p}(\Omega) \to W^{j,q}(\Omega_0^k) & & \text{if } n = mp, 1\leq k \leq n \text{ and }
          1\leq q <\infty. \label{eq:6.4}
      \end{align}
    \item If $\Omega$ satisfies the cone condition and $mp > n$, then the following imbeddings are compact:
      \begin{align}
        & W^{j+m,p}(\Omega) \to C_B^j(\Omega_0) \label{eq:6.5} \\
        & W^{j+m,p}(\Omega) \to W^{j,q}(\Omega_0^k) \qquad \text{if } 1\leq q < \infty. \label{eq:6.6}
      \end{align}
    \item If $\Omega$ satisfies the strong local Lipschitz condition, then the following imbeddings are compact:
      \begin{align}
        W^{j+m,p}(\Omega) \to C^j(\overline{\Omega_0}) \qquad & \text{if } mp > n, \label{eq:6.7} \\
        W^{j+m,p}(\Omega) \to C^{j,\lambda}(\overline{\Omega_0}) \qquad & \text{if } mp > n \geq (m-1)p
          \text{ and } 0 < \lambda < m - (n/p). \label{eq:6.8}
      \end{align}
    \item If $\Omega$ is an arbitrary domain in $\mathbb{R}^n$, the imbeddings \eqref{eq:6.3}--\eqref{eq:6.8}
      are compact provided $W^{j+m,p}(\Omega)$ is replaced by $W^{j+m,p}_0(\Omega)$.
  \end{enumerate}
\end{theorem}


\begin{remarks}
  \begin{enumerate}[1.]
    \item Note that if $\Omega$ is bounded, we may have $\Omega_0 = \Omega$ in the statement of the theorem.
    \item If $X$, $Y$, and $Z$ are spaces for which we have the imbeddings $X\to Y$ and $Y\to Z$,
      and one of these imbeddings is compact, then the composite imbedding $X\to Z$ is compact.
      Thus, for example, if $Y\to Z$ is compact, then any sequence $\{u_j\}$ bounded in $X$ will
      be bounded in $Y$ and will therefore have a subsequence $\{u_j'\}$ convergent in $Z$.
    \item Since the extension operator $u\to\tilde{u}$, where $\tilde{u}(x) = u(x)$ if $x\in\Omega$
      and $\tilde{u}(x) = 0$ if $x\notin \Omega$,
      defines an imbedding $W_0^{j+m,p}(\Omega) \to W^{j+m,p}(\mathbb{R}^n)$ by Lemma~3.27, Part IV of Theorem~6.3
      follows from application of Parts I--III to $\mathbb{R}^n$.
    \item In proving the compactness of any of the imbeddings \eqref{eq:6.3}--\eqref{eq:6.8} it is
      sufficient to consider only the case $j=0$. For $j\geq 1$ and $\{u_i\}$ a bounded sequence in
      $W^{j+m,p}(\Omega)$ it is clear that $\{D^\alpha u_i\}$ is bounded in $W^{m,p}(\Omega)$ for each $\alpha$
      such that $|\alpha|\leq j$. Hence $\{D^\alpha u_i|_{\Omega_0^k}\}$ is precompact in $L^q(\Omega_0^k)$
      with $q$ specified as in \eqref{eq:6.3}. It is possible, therefore, to select (by finite induction)
      a subsequence $\{u_i'\}$ of $\{u_i\}$ for which $\{D^\alpha u_i'|_{\Omega_0^k}\}$
      converges in $L^q(\Omega_0^k)$ for each $\alpha$ such that $|\alpha|\leq j$.
      Thus $\{u_i'|_{\Omega_0^k}\}$ converges in $W_0^{j,q}(\Omega_0^k)$ and \eqref{eq:6.3} is compact.
    \item Since $\Omega_0$ is bounded, $C_B^0(\Omega_0^k)\to L^q(\Omega_0^k)$ for $1\leq q\leq \infty$;
      in fact $\|u\|_{0,q,\Omega_0^k} \leq \|u\|_{C_B^0(\Omega_0^k)} \bigl[\vol (\Omega_0^k)\bigr]^{1/q}$.
      Thus the compactness of \eqref{eq:6.6} (for $j=0$) follows from that of \eqref{eq:6.5}.
    \item For the purpose of proving Theorem 6.3 the bounded subdomain $\Omega_0$ of $\Omega$ may be assumed
      to satisfy the cone condition in $\Omega$ does. If $C$ is a finite cone determining the cone condition
      for $\Omega$, let $\widetilde{\Omega}$ be the union of all finite cones congruent to $C$, contained in
      $\Omega$ and having nonempty intersection with $\Omega_0$.
      Then $\Omega_0\subset\widetilde{\Omega}\subset\Omega$ and $\widetilde{\Omega}$ is bounded and satisfies
      the cone condition. If $W^{m,p}(\Omega)\to X(\widetilde{\Omega})$ is compact, then so is
      $W^{m,p}\to X(\Omega_0)$ by restriction.
  \end{enumerate}
\end{remarks}

\begin{para}[Proof of Theorem 6.3, Part III]
  If $mp > n\geq (m-1)p$ and if $0 < \lambda < m-(n/p)$, then there exists $\mu$ such that
  $\lambda < \mu < m-(n/p)$. Since $\Omega_0$ is bounded,
  the imbedding $C^{0,\mu}(\overline{\Omega_0})\to C^{0,\lambda}(\overline{\Omega_0})$ is compact by Theorem~1.34.
  Since $W^{m,p}(\Omega)\to C^{0,\mu}(\overline{\Omega})\to C^{0,\mu}(\overline{\Omega_0})$ by Theorem~4.12
  and restriction, imbedding \eqref{eq:6.8} is compact for $j=0$ by Remark 6.4(2).

  If $mp>n$, let $j^*$ be the nonnegative integer satisfying the inequalities
  $(m-j^*)p > n \geq (m-j^*-1)p$. Then we have the imbedding chain
  \begin{equation}\label{eq:6.9}
    W^{m,p}(\Omega) \to W^{m-j^*,p}(\Omega) \to C^{0,\mu}(\overline{\Omega_0}) \to C(\overline{\Omega_0})
  \end{equation}
  where $0 < \mu < m-j^*-(n/p)$. The last imbeddings in \eqref{eq:6.9} is compact by Theorem 1.34.
  Thus \eqref{eq:6.7} is compact for $j=0$.
\end{para}


\begin{para}[Proof of Theorem 6.3, Part II]
  As noted in Remark 6.4(6), $\Omega_0$ may be assumed to satisfy the cone condition.
  Since $\Omega_0$ is bounded it can, by Lemma~4.22 be written as a finite union,
  $\Omega_0 = \bigcup_{k=1}^M \Omega_k$, where each $\Omega_k$ satisfies the strong local Lipschitz
  condition. If $mp>n$, then
  \[W^{m,p}(\Omega) \to W^{m,p}(\Omega_k) \to C(\overline{\Omega_k}),\]
  the latter imbedding being compact as proved above. If $\{u_i\}$ is a sequence bounded in $W^{m,p}(\Omega)$,
  we may select by finite induction on $k$ a subsequence $\{u_i'\}$ whose restriction to $\Omega_k$
  converges in $C(\overline{\Omega_k})$ for each $k$, $1\leq k\leq M$.
  But this subsequence then converges in $C_B^0(\Omega_0)$, so proving that \eqref{eq:6.5} is compact
  for $j=0$. Therefore \eqref{eq:6.6} is also compact by Remark 6.4(5).
\end{para}


\begin{lemma}\label{lemma:6.7}
  Let $\Omega$ be a domain in $\mathbb{R}^n$, $\Omega_0$ a subdomain of $\Omega$,
  and $\Omega_0^k$ the intersection of $\Omega_0$ with a $k$-dimensional plane in
  $\mathbb{R}^n$ ($1\leq k\leq n$). Let $1\leq q_1<q_0$ and suppose that
  \[ W^{m,p}(\Omega) \to L^{q_0}(\Omega_0^k) \]
  and
  \[ W^{m,p}(\Omega) \to L^{q_1}(\Omega_0^k) \qquad \text{compactly}. \]
  If $q_1\leq q<q_0$, then
  \[ W^{m,p}(\Omega) \to L^q(\Omega_0^k) \qquad \text{compactly}. \]
\end{lemma}

\begin{proof}
  Let $\lambda = q_1(q_0-q)/q(q_0-q_1)$ and $\mu = q_0(q-q_1)/q(q_0-q_1)$.
  Then $\lambda>0$ and $\mu\geq 0$. By H\"older's inequality there exists a constant
  $K$ such that for all $u\in W^{m,p}(\Omega)$,
  \[ \|u\|_{0,q,\Omega_0^k} \leq \|u\|_{0,q_1,\Omega_0^k}^\lambda \|u\|_{0,q_0,\Omega_0^k}^\mu
      \leq K \|u\|_{0,q_1,\Omega_0^k}^\lambda \|u\|_{m,p,\Omega}^\mu. \]
  A sequence bounded in $W^{m,p}(\Omega)$ has a subsequence which converges in
  $L^{q_1}(\Omega_0^k)$ and is therefore a Cauchy sequence in that space.
  Applying the inequality above to differences between terms of this sequence shows
  that it is also a Cauchy sequence in $L^q(\Omega_0^k)$, so the imbedding
  of $W^{m,p}(\Omega)$ into $L^q(\Omega_0^k)$ is compact.
\end{proof}


\begin{para}[Proof of Theorem 6.3, Part I]
  First we deal with (the case $j=0$ of) imbedding (3). Assume for the moment that $k=n$
  and let $q_0 = np/(n-mp)$. In order to prove that the imbedding
  \begin{equation}\label{eq:6.10}
    W^{m,p}(\Omega) \to L^q(\Omega_0), \qquad 1\leq q<q_0,
  \end{equation}
  is compact, it sufficed, by Lemma 6.7, to do so only for $q=1$.
  For $j=1,2,3,\ldots$ let
  \[ \Omega_j = \{x\in\Omega : \dist(x, \partial\Omega) > 2/j \}. \]
  Let $S$ be a set of functions bounded in $W^{m,p}(\Omega)$. We show that $S$
  (when restricted to $\Omega_0$) is precompact in $L^1(\Omega_0)$ by showing that $S$
  satisfies the conditions of Theorem~2.32. Accordingly, let $\epsilon>0$
  be given and for each $u\in W^{m,p}(\Omega)$ set
  \[ \tilde{u}(x) = \begin{cases}
    u(x) & \text{if}\ x\in\Omega_0 \\
    0    & \text{otherwise.}
  \end{cases} \]
  By H\"older's inequality and since $W^{m,p}(\Omega)\to L^{q_0}(\Omega_0)$, we have
  \begin{align*}
    \int_{\Omega_0-\Omega_j} |u(x)| \d x
    & \leq \biggl(\int_{\Omega_0-\Omega_j} |u(x)|^{q_0} \d x\biggr)^{1/q_0}
           \biggl(\int_{\Omega_0-\Omega_j} 1 \d x\biggr)^{1-1/q_0} \\
    & \leq K_1 \|u\|_{m,p,\Omega} [\vol(\Omega_0-\Omega_j)]^{1-1/q_0},
  \end{align*}
  with $K_1$ independent of $u$. Since $q_0>1$ and $\Omega_0$ has finite volume,
  $j$ may be selected large enough to ensure that for every $u\in S$,
  \[\int_{\Omega_0-\Omega_j} |u(x)| \d x < \epsilon \]
  and also, for every $h\in\mathbb{R}^n$,
  \[\int_{\Omega_0-\Omega_j} |\tilde{u}(x+h) - \tilde{u}(x)| \d x < \frac{\epsilon}{2}.\]
  Now if $|h|<1/j$, then $x+th\in \Omega_{2j}$ provided $x\in\Omega_j$ and $0<t<1$.
  If $u\in C^\infty(\Omega)$, it follows that
  \begin{align*}
    \int_{\Omega_j} |u(x+h)-u(x)| \d x
    & \leq \int_{\Omega_j} \d x \int_0^1 \biggl|\frac{\d}{\d t} u(x+th)\biggr| \d t \\
    & \leq |h| \int_0^1 \d t \int_{\Omega_{2j}} |\nabla u(y)| \d y \\
    & \leq |h| \|u\|_{1,1,\Omega_0}
      \leq K_2 |h| \|u\|_{m,p,\Omega},
  \end{align*}
  where $K_2$ is independent of $u$.
  Since $C^\infty(\Omega)$ is dense in $W^{m,p}(\Omega)$, this estimate
  holds for any $u\in W^{m,p}(\Omega)$. Hence if $|h|$ is sufficiently small,
  we have
  \[\int_{\Omega_0} |\tilde{u}(x+h) - \tilde{u}(x)| \d x < \epsilon.\]
  Hence $S$ is precompact in $L^1(\Omega_0)$ by Theorem~2.32 and imbedding (10)
  is compact. Next suppose that $k<n$ and $p>1$.
  The Sobolev Imbedding Theorem~4.12 assures us that $W^{m,p}(\Omega)\to L^{kp/(n-mp)}(\Omega_0^k)$.
  For any $q<kp/(n-mp)$ we can choose $r$ such that $1\leq r<p$, $n-mr<k$,
  and $q\leq kr/(n-mr)<kp/(n-mp)$. Since $\Omega_0$ is bounded, the imbeddings
  \[ W^{m,p}(\Omega) \to W^{m,p}(\Omega_0) \to W^{m,r}(\Omega_0) \]
  exist. By Theorem~5.10 we have
  \begin{align*}
    \|u\|_{q,\Omega_0^k}
    & \leq K_1 \|u\|_{kr/(n-mr), \Omega_0^k} \\
    & \leq K_2 \|u\|_{nr/(n-mr), \Omega_0}^{1-\theta} \|u\|_{m,r,\Omega_0}^\theta \\
    & \leq K_3 \|u\|_{nr/(n-mr), \Omega_0}^{1-\theta} \|u\|_{m,p,\Omega}^\theta,
  \end{align*}
  where $K_j$ and $\theta$ are constants (independent of $u\in W^{m,p}(\Omega)$)
  and $\theta$ satisfies $0<\theta<1$.
  Since $nr/(n-mr) < np/(n-mp)$, a sequence bounded in $W^{m,p}(\Omega)$
  must have a subsequence convergent in $L^{nr/(n-mr)}(\Omega_0)$ by the earlier
  part of this proof. That sequence is therefore a Cauchy sequence in $L^{nr/(n-mr)}(\Omega_0)$,
  and by the above inequality it is therefore a Cauchy sequence in $L^q(\Omega_0^k)$,
  so the imbedding $W^{m,p}(\Omega) \to L^q(\Omega_0^k)$ is compact and so is
  $W^{m,p}(\Omega) \to L^1(\Omega_0^k)$.

  If $p=1$ and $0\leq n-m<k<n$, then necessarily $m\geq 2$.
  Composing the continuous imbedding $W^{m,1}(\Omega)\to W^{m-1,r}(\Omega)$,
  where $r = n/(n-1) > 1$, with the compact imbedding $W^{m-1,r}(\Omega)\to L^1(\Omega_0^k)$,
  (which is compact because $k\geq n-(m-1) > n-(m-1)r$),
  completes the proof of the compactness of (3).

  To prove that imbedding (4) is compact we proceed as follows. If $n=mp$,
  $p>1$ and $1\leq q<\infty$, then we may select $r$ so that $1\leq r<p$,
  $k>n-mr>0$, and $kr/(n-mr)>q$. Assuming again that $\Omega_0$ satisfies
  the cone condition, we have
  \[ W^{m,p}(\Omega) \to W^{m,r}(\Omega_0) \to L^q(\Omega_0^k). \]
  The latter imbedding is compact by (3).
  If $p=1$ and $n=m\geq 2$, then, setting $r=n/(n-1)>1$ so that $n=(n-1)r$,
  we have for $1\leq q<\infty$,
  \[W^{n,1}(\Omega) \to W^{n-1,r}(\Omega) \to L^q(\Omega_0^k), \]
  the latter imbedding being compact as shown immediately above.
  Finally, if $n=m=p=1$, then $k=1$ also. Letting $q_0>1$ be arbitrarily chosen
  we prove the compactness of $W^{1,1}(\Omega) \to L^1(\Omega_0)$ exactly as in the case
  $k=n$ considered at the beginning of this proof.
  Since $W^{1,1}(\Omega)\to L^q(\Omega_0)$ for $1\leq q<\infty$,
  all these imbeddings are compact by Lemma~6.7.
\end{para}


\section{Two Counterexamples}\label{sec:Two-Counterexamples}

\begin{para}[Quasibounded Domains]
  We say that an unbounded domain $\Omega\subset\mathbb{R}^n$ is
  \emph{quasibounded} if
  \[ \lim_{\substack{x\in\Omega\\ |x|\to\infty}} \dist(x,\partial\Omega) = 0. \]
  An unbounded domain is not quasibounded if and only if it contains infinitely
  many pairwise disjoint congruent balls.
\end{para}

\begin{para}
  Two obvious questions arise from consideration of the statement of the Rellich-Kondrachov
  Theorem~6.3. First, can the theorem be extended to cover unbounded $\Omega_0$?
  Second, can the \emph{extreme cases}
  \begin{align*}
    W^{j+m,p}(\Omega) \to W^{j,q}(\Omega_0^k),
    & 0<n-, p<k\leq n, \\
    & q = kp/(n-mp)
  \end{align*}
  and
  \begin{align*}
    W^{j+m,p}(\Omega) \to C^{j,\lambda}(\overline{\Omega_0}),
    & mp>n>(m-1)p, \\
    & \lambda = m-(n/p)
  \end{align*}
  ever be compact? The first of these questions will be investigated later in this chapter.
  For the moment though we show that that answer is negative if $k=n$ and $\Omega_0$
  is not quasibounded. However, the situation changes (see [Lp]) for subspaces of symmetric
  functions.
\end{para}

\begin{example}
  Let $\Omega$ be an unbounded domain in $\mathbb{R}^n$ that is not quasibounded.
  Then there exists a sequence $\{B_i\}$ of mutually disjoint open balls contained
  in $\Omega$ and all having the same positive radius.
  Let $\phi_1\in C_0^\infty(B_1)$ satisfy $\|\phi_1\|_{j,p,B_1}=A_{j,p}>0$
  for each $j=0,1,2,\ldots$ and each $p\geq 1$.
  Let $\phi_i$ be a translate of $\phi_1$ having support in $B_i$.
  Then $\{\phi_i\}$ is a bounded sequence in $W^{m,p}_0(\Omega)$
  for any fixed $m$ and $p$. But for any $q$,
  \[\|\phi_i-\phi_k\|_{j,q,\Omega}
    = \Bigl(\|\phi_i\|_{j,q,B_i}^q + \|\phi_k\|_{j,q,B_i}^q\Bigr)^{1/q}
    = 2^{1/q} A_{j,q} >0\]
  so that $\{\phi_i\}$ cannot have a sequence converging in $W^{j,q}(\Omega)$
  for any $j\geq 0$. Thus no compact imbedding of the form
  $W^{j+m,p}_0(\Omega)\to W^{j,q}(\Omega)$ is possible.
  The non-compactness of the other imbeddings of Theorem 6.3 is proved similarly.
\end{example}

Now we provide an example showing that the answer to the second question
raised in Paragraph 6.10 is always negative.

\begin{example}
  Let integers $j,m,n$ be given with $j\geq 0$ and $m,n\geq 1$.
  Let $p\geq 1$. If $mp<n$, let $k$ be an integer such that $n-mp<k\leq n$
  and let $q=kp/(n-mp)$. If $(m-1)p<n<mp$, let $\lambda=m-(n/p)$. Let $\Omega$
  be a domain in $\mathbb{R}^n$ and let $\Omega_0$ be a nonempty bounded subdomain
  of $\Omega$ having nonempty intersection $\Omega_0^k$ with a $k$-dimensional
  plane $H$ in $\mathbb{R}^n$ which, without loss of generality, we can take
  to be the plane $\mathbb{R}^k$ spanned by the $x_1$, $x_2$, $\ldots$, $x_k$
  coordinate axes. We show that the imbeddings
  \begin{align}
    W^{j+m,p}(\Omega) \to W^{j,q}(\Omega_0^k) \qquad & \text{if}\ mp<n \\
    W^{j+m,p}(\Omega) \to C^{j,\lambda}(\overline{\Omega_0}) \qquad & \text{if}\ (m-1)p\leq n<mp
  \end{align}
  cannot be compact.

  Let $B_r(x)$ be the open ball of radius $r$ in $\mathbb{R}^n$ centred at $x$
  and let $\phi$ be a nontrivial function in $C_0^\infty(B_1(0))$.
  Let $\{a_i\}$ be a sequence of distinct points in $\Omega_0^k$,
  and let $B_i=B_{r_i}(a_i)$ where the positive radii $r_i$ satisfy $r_i\leq 1$
  and are chosen so that the balls $B_i$ are pairwise disjoint and contained in $\Omega_0$.
  We define a scaled, translated dilation $\phi_i$ of $\phi$ with support in $B_i$ by
  \[\phi_i(x) = r_i^{j+m-(n/p)}\phi(y), \qquad \text{where}\ x = a_i+r_iy.\]
  The functions $\phi_i$ have disjoint supports in $\Omega_0$ and, since
  $D^\alpha \phi_i(x) = r^{-|\alpha|} D^\alpha \phi(y)$ and $\d x = r_i^n \d y$,
  we have, for $|\alpha|\leq j+m$,
  \[\int_\Omega |D^\alpha\phi_i(x)|^p \d x
    = r_i^{(j+m-|\alpha|)p}\int_\Omega |\mathscr{D}^\alpha \phi(y)|^p \d y.\]
  Therefore, $\{\phi\}$ is bounded in $W^{j+m,p}(\Omega)$.

  On the other hand, $\d x_1\cdots\d x_k = r_i^k \d y_1\cdots \d y_k$,
  so that if $|\alpha|=j$, then
  \[\int_{\Omega_0^k} |D^\alpha\phi_i(x)|^q \d x_1\cdots\d x_k
    = r_i^{k+q[m-(n/p)]} \int_{\mathbb{R}^n} |D^\alpha\phi(y)|^q \d y_1\cdots\d y_k.\]
  Since $k+q[m-(n/p)] = 0$, this shows that
  \[\|\phi_i\|_{j,q,\Omega_0^k} \geq |\phi_i|_{j,q,\Omega_0^k} = C_1 |\phi|_{j,q,\mathbb{R}^k} > 0\]
  for all $i$, and $\{\phi_i\}$ is bounded away from zero in $W^{j,q}(\Omega_0^k)$.
  The disjointness of the supports of the functions $\phi_i$ now implies that
  $\{\phi\}$ can have no subsequence converging in $W^{j,q}(\Omega_0^k)$,
  so the imbedding (11) cannot be compact.

  Now suppose that $(m-1)p\leq n<mp$. Let $a$ be a point in $B_1(0)$
  and $\beta$ be a particular multiindex satisfying $|\beta|=j$
  such that $|D^\beta\phi(a)|=C_2>0$.
  Let $b_i = a_i+r_ia$ and let $c_i$ be the point on the boundary of $B_i$ closest
  to $b_i$. We have
  \[|D^\beta\phi_i(b_i)| = r_i^{m-(n/p)} C_2 = r_i^\lambda C_2,\]
  and, since $D^\beta\phi_i(c_i) = 0$,
  \[\|\phi_i\|_{C^{j,\lambda}(\overline{\Omega_0})}
    \geq \frac{|D^\beta\phi_i(b_i) - D^\beta\phi_i(c_i)|}{|b_i-c_i|^\lambda} = C_2 > 0.\]
  Again, this precludes the existence of a subsequence of $\{\phi_i\}$
  convergent in $C^{j,\lambda}(\overline{\Omega_0})$, so the imbedding (12)
  cannot be compact.
\end{example}


\begin{remark}
  Observe that the above examples in fact showed that no imbeddings of $W_0^{j+m,p}(\Omega)$,
  not just of the larger space $W^{j+m,p}(\Omega)$, into the appropriate target space
  can be compact. We now examine the possibility of obtaining compact imbeddings of $W_0^{m,p}(\Omega)$
  for certain unbounded domains.
\end{remark}


\section{Unbounded Domains---Compact Imbeddings of $W_0^{m,p}(\Omega)$}

\begin{para}
  Let $\Omega$ be an unbounded domain in $\mathbb{R}^n$. We shall be concerned
  below with determining whether the imbedding
  \begin{equation}\label{eq:6.13}
    W_0^{m,p}(\Omega) \to L^p(\Omega)
  \end{equation}
  is compact. If it is, then it will follow by Remark 6.4(4), Lemma 6.7,
  and the second part of the proof in Paragraph 6.8 that the imbeddings
  \begin{align*}
    & W_0^{j+m,p}(\Omega) \to W^{j,q}(\Omega_k), \qquad
      0< n-mp < k \leq n, \quad p\leq q < kp(n-mp), \\
    & W_0^{j+m,p}(\Omega) \to W^{j,q}(\Omega_k), \qquad
      n = mp, \quad 1\leq k\leq n, p \leq q < \infty
  \end{align*}
  are also compact. See Theorem 6.28 for the corresponding compactness of imbeddings
  into continuous function spaces.

  As was shown in Example 6.11, imbedding \eqref{eq:6.13} cannot be compact unless
  $\Omega$ is quasibounded. In Theorem 6.16 we give a geometric condition on $\Omega$
  that is sufficient to guarantee the compactness of \eqref{eq:6.13},
  and in Theorem 6.19 we give an analytic condition that is necessary and sufficient
  for the compactness of \eqref{eq:6.13}. Both theorems are from [A2].
\end{para}


\begin{para}
  Let $\Omega_r$ denote the set $\{x\in\Omega: |x|\geq r\}$.
  In the following discussion any cube $H$ referred to will have its edges parallel
  to the coordinate axes. For a domain $\Omega$, a cube $H$, and an integer $\nu$
  satisfying $1\leq\nu\leq n$, we define the quantity $\mu_{n-\nu}(H,\Omega)$
  to be the maximum of the $(n-\nu)$-measure of $P(H-\Omega)$ taken over
  all projections $P$ onto $(n-\nu)$-dimensional faces of $H$.
\end{para}


\begin{theorem}
  Let $\nu$ be an integer such that $1\leq\nu\leq n$ and $mp>\nu$
  (or $m=p=\nu=1$). Suppose that for every $\epsilon>0$ there exist
  numbers $h$ and $r$ with $0<h\leq 1$ and $r\geq 0$ such that for every
  cube $H\subset \mathbb{R}^n$ having side $h$ and nonempty intersection
  with $\Omega_r$ we have
  \[\frac{\mu_{n-\nu}(H,\Omega)}{h^{n-\nu}} \geq \frac{h^p}{\epsilon}.\]
  Then imbedding \eqref{eq:6.13} is compact.
\end{theorem}


\begin{remarks}
  \begin{enumerate}
    \item We will deduce this theorem from Theorem~6.19 later in this section.
    \item The above theorem shows that for quasibounded $\Omega$ the compactness
      of (13) may depend in an essential way on the dimension of $\partial\Omega$.
    \item For $\nu = n$, the condition of Theorem~6.16 places only the minimum
      restriction of quasiboundedness on $\Omega$; if $mp>n$ then (13) is compact
      for any quasibounded $\Omega$. It can also be shown that of $p>1$ and $\Omega$
      is quasibounded with boundary having no finite accumulation points,then
      (13) cannot be compact unless $mp>n$.
    \item If $\nu=1$, the condition of Theorem~6.16 places no restrictions on $m$
      and $p$ but requires that $\partial\Omega$ be ``essentially $(n-1)$-dimensional.''
      Any quasibounded domain whose boundary consists of reasonably regular
      $(n-1)$-dimensional surfaces will satisfy that condition.
      An example of such a domain is the ``spiny urchin'' of Figure~4, a domain in $\mathbb{R}^2$
      obtained by deleting from the plane the union of the sets $S_k$, ($k=1,2,\ldots$),
      specified in polar coordinates by
      \[ S_k = \bigl\{(r,\theta): r\geq k,\,\theta = n\pi/2^k,\,n=1,2,\ldots,2^{k+1}\bigr\}. \]
      Note that this domain, though quasibounded, is simply connected and has empty exterior.
    \item More generally, if $\nu$ is the largest integer less than $mp$,
      the condition of Theorem~6.16 requires in a certain sense that the part of the
      boundary of $\Omega$ having dimension at least $n-\nu$ should bound a quasibounded domain.
  \end{enumerate}
\end{remarks}


\begin{para}[A Definition of Capacity]
  Let $H$ be a cube of edge length $h$ in $\mathbb{R}^n$ and let $E$ be a closed subset of $H$.
  Given $m$ and $p$ we define a functional $I_H^{m,p}$ on $C^\infty(H)$ by
  \[ I_H^{m,p}(u) = \sum_{1\leq j\leq m} h^{jp} |u|_{j,p,H}^p
     = \sum_{1\leq |\alpha|\leq m} h^{|\alpha|p} \int_H |D^\alpha u(x)|^p \d x. \]
  Let $C^\infty(H,E)$ denote the set of all nontrivial functions $u\in C^\infty(H)$
  that vanish identically in a neighborhood of $E$. We define the $(m,p)$-capacity
  $Q^{m,p}(H,E)$ of $E$ in $H$ by
  \[ Q^{m,p}(H,E) = \inf \biggl\{ \frac{I_H^{m,p}(u)}{\|u\|_{0,p,H}^p}
     : u\in C^\infty(H,E)\biggr\}. \]
  Clearly $Q^{m,p}(H,E) \leq Q^{m+1,p}(H,E)$ and, whenever $E\subset F\subset H$,
  we have $Q^{m,p}(H,E) \leq Q^{m,p}$(H,F).
\end{para}

The following theorem characterizes those domains for which imbedding (13)
is compact in terms of this capacity.


\begin{theorem}
  Imbedding (13) is compact if and only if $\Omega$ satisfies the following condition:
  For every $\epsilon>0$ there exists $h\leq 1$ and $r>0$ such that the inequality
  \[ Q^{m,p}(H,H-\Omega) \geq h^p/\epsilon \]
  holds for every $n$-cube $H$ of edge length $h$ having nonempty intersection
  with $\Omega_r$. (This condition clearly implies that $\Omega$ is quasibounded.)
\end{theorem}

Prior to proving this theorem we prepare the following lemma.


\begin{lemma}
  There exists a constant $K(m,p)$ such that for any $n$-cube $H$ of edge length $h$,
  any measurable subset $A$ of $H$ with positive volume, and any $u\in C^1(H)$, we have
  \[ \|u\|_{0,p,H}^p \leq \frac{2^{p-1}h^n}{\vol(A)} \|u\|_{0,p,A}^p
      + K \frac{h^{n+p}}{\vol(A)} \|\nabla u\|_{0,p,H}^p. \]
\end{lemma}


\begin{proof}
  Let $y\in A$ and $x=(\rho,\phi)\in H$, where $(\rho,\phi)$ denote spherical coordinates
  centred at $y$, in terms of which the volume element is given by
  $\d x = \omega(\phi) \rho^{n-1} \d\rho\d\phi$. Let $\partial H$ be specified by $\rho = f(\phi)$,
  $\phi\in\Sigma$. Clearly $f(\phi) \leq\sqrt{n}h$. Since
  \[ u(x) = u(y) + \int_0^\rho \frac{\d}{\d r} u(r,\phi) \d r, \]
  we have by Lemma~2.2 and H\"older's inequality
  \begin{align*}
    & \int_H |u(x)|^p \d x \\
    & \leq 2^{p-1} h^n |u(y)|^p + 2^{p-1} \int_H \biggl|\int_0^\rho
        \frac{\d}{\d r} u(r,\phi) \d r\biggr|^p \d x \\
    & \leq 2^{p-1} h^n |u(y)|^p + 2^{p-1} \int_\Sigma \omega(\phi) \d\phi
        \int_0^{f(\phi)} \rho^{n+p-2} \d\rho \int_0^\rho |\nabla u(r,\phi)|^p \d r \\
    & \leq 2^{p-1} h^n |u(y)|^p + \frac{2^{p-1}}{n+p-1} (\sqrt{n}h)^{n+p-1}
        \int_H \frac{|\nabla u(z)|^p}{|z-y|^{n-1}} \d z.
  \end{align*}
  Integrating $y$ over $A$ and using Lemma~4.64 we obtain
  \[ \vol(A) \|u\|_{0,p,H}^p \leq 2^{p-1} h^n \|u\|_{0,p,A}^p
      + K h^{n+p} \|\nabla u\|_{0,p,H}^p, \]
  as required.
\end{proof}


\begin{para}[Proof of Theorem 6.19--Necessity]
  Suppose that $\Omega$ does not satisfy the condition stated in the theorem.
  Then there exists a finite constant $K_1 = 1/\epsilon$ such that for every $h$
  with $0<h\leq 1$ there exists a sequence $\{H_j\}$ of mutually disjoint cubes of
  edge length $h$ which intersect $\Omega$ and for which
  \[ Q^{m,p}(H_j, H_j-\Omega) < K_1 h^p. \]
  By the definition of capacity, for each such cube $H_j$ there exists a function
  $u_j\in C^\infty(H_j,H_j-\Omega)$ such that $\|u_j\|_{0,p,H_j}^p = h^n$,
  $\|\nabla u_j\|_{0,p,H_j}^p \leq K_1h^n$, and $\|u_j\|_{m,p,H_j}^p\leq K_2(h)$.
  Let $A_j = \{x\in H_j: |u_j(x)|<\frac12\}$. By the previous Lemma we have
  \[ h^n \leq \frac{2^{p-1}h^n}{\vol(A_j)} \cdot \frac{\vol(A_j)}{2^p} 
      + \frac{KK_1}{\vol(A_j)} h^{2n+p} \]
  from which it follows that $\vol(A_j) \leq K_3 h^{n+p}$.
  Let us choose $h$ so small that $K_3 h^p\leq\frac13$, whence $\vol(A_j) \leq \frac13 \vol(H_j)$.
  Choose functions $w_j\in C_0^\infty(H_j)$ such that $w_j(x)=1$ on a subset $S_j$ of $H_j$
  having volume no less than $\frac23 \vol(H_j)$, and such that
  \[ \sup_j \max_{|\alpha|\leq m} \sup_{x\in H_j} |D^\alpha w_j(x)| = K_4(h) < \infty. \]
  Then $v_j = u_jw_j \in C_0^\infty(H_j\cap\Omega)\subset C_0^\infty(\Omega)$
  and $|v_j(x)|\geq\frac12$ on $S_j\cap (H_j-A_j)$, a set of volume no less than
  $h^n/3$. Hence $\|v_j\|_{0,p,H_j}^p \geq h^n/3 \cdot 2^p$. On the other hand
  \[ \int_{H_j} |D^\alpha u_j(x)|^p \cdot |D^\beta w_j(x)|^p \d x
      \leq K_4(h) K_2(h) \]
  provided $|\alpha|,|\beta|\leq m$. Hence $\{v_j\}$ is a bounded sequence in $W_0^{m,p}(\Omega)$.
  Since the supports of the functions $\{v_j\}$ are disjoint,
  $\|v_i-v_j\|_{0,p,\Omega}^p \geq 2h^n/3 \cdot 2^p$ so the imbedding (13)
  cannot be compact.
\end{para}


\begin{para}[Proof of Theorem 6.19--Sufficiency]
  Suppose $\Omega$ satisfies the condition stated in the theorem.
  Let $\epsilon>0$ be given and choose $r\geq 0$ and $h\leq 1$
  such that for every cube $H$ of edge $h$ intersecting $\Omega_r$
  we have $Q^{m,p}(H,H-\Omega)\geq h^p/\epsilon^p$. Then for every
  $u\in C_0^\infty(\Omega)$ we obtain
  \[ \|u\|_{0,p,H}^p \leq \frac{\epsilon^p}{h^p} I_H^{m,p}(u) \leq \epsilon^p \|u\|_{m,p,H}^p. \]
  Since a neighborhood of $\Omega_r$ can be tessellated by such cubes $H$
  we have by summation
  \[ \|u\|_{0,p,\Omega_r} \leq \epsilon \|u\|_{m,p,\Omega}. \]
  That any bounded set $S$ in $W_0^{m,p}(\Omega)$ is precompact in $L^p(\Omega)$
  now follows from Theorem~2.33 and~6.3.
\end{para}


\begin{lemma}
  There is a constant $K$ independent of $h$ such that for any cube $H$
  in $\mathbb{R}^n$ having edge length $h$, for every $q$ satisfying $p\leq q\leq np/(n-mp)$
  (or $p\leq q<\infty$ if $mp=n$, or $p\leq q\leq\infty$ if $mp>n$),
  and for every $u\in C^\infty(H)$ we have
  \[ \|u\|_{0,q,H} \leq K\biggl(\sum_{|\alpha|\leq m} h^{|\alpha|p-n+np/q}
      \|D^\alpha u\|_{0,p,H}^p\biggr)^{1/p}. \]
\end{lemma}


\begin{proof}
  We may suppose $H$ to be centred at the origin and let $\tilde{H}$ be the cube
  of unit edge concentric with $H$ and having edges parallel to those of $H$.
  The stated inequality holds for $\tilde{u}\in C^\infty(\tilde H)$ by the Sobolev
  imbedding theorem. It then follows for $H$ via the dilation $u(x)=\tilde u(x/h)$.
\end{proof}


\begin{lemma}
  If $mp>n$ (or $m=p=n=1$), there exists a constant $K=K(m,p,n)$ such that
  for every cube $H$ of edge length $h$ in $\mathbb{R}^n$ and every $u\in C^\infty(H)$
  that vanishes in a neighborhood of some point $y\in H$, we have
  \[ \|u\|_{0,p,H}^p \leq K I_H^{m,p}(u). \]
\end{lemma}

\begin{proof}
  Let $(\rho,\phi)$ be spherical coordinates centred at $y$. Then
  \[ u(\rho,\phi)  = \int_0^\rho \frac{\d}{\d t} u(t,\phi) \d t. \]
  If $n>(m-1)p$, then let $q = np/(n-mp+p)$, so that $q>n$.
  Otherwise let $q>\max\{n,p\}$ be an arbitrary and finite. If $(\rho,\phi)\in H$,
  then by H\"older's
\end{proof}