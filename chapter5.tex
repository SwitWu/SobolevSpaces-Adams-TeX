\chapter{Interpolation, Extension And Approximation Theorems}

\section{Interpolation on Order of Smoothness}

\begin{para}
  We consider the problem of determining upper bounds for $L^p$ norms of
  derivatives $D^\beta u$, $0<|\beta|<m$, of functions in $W^{m,p}(\Omega)$
  in terms of the $L^p$ norms of $u$ and its partial derivatives of order $m$.
  Such estimates are conveniently expressed in terms of the seminorms $|\cdot|_{j,p}$
  defined in Paragraph~4.29. Theorem~5.2 below provides such an estimate for
  the seminorm $|u|_{j,p}$ in terms of $|u|_{m,p}$ and $\|u\|_p$, as well as
  some elementary consequences of this estimate. Such estimates arose
  in the work of Ehrling [E], Nirenberg [Nr1, Nr2], Gagliardo [Ga1, Ga2],
  and Browder [Br1, Br2], and were frequently proved under the assumption
  that $\Omega$ satisfies the uniform cone condition, at least if $\Omega$
  is unbounded. However, we will prove Theorem~5.2 assuming only the cone
  condition. In fact, even the weak cone condition is sufficient for the proof,
  as is shown in [AF1].
\end{para}


\begin{theorem}
  Let $\Omega$ be a domain in $\mathbb{R}^n$ satisfying the cone condition.
  For each $\epsilon_0>0$ there exist finite constants $K$ and $K'$, each
  depending on $n$, $m$, $p$, $\epsilon_0$ and the dimensions of the cone $C$
  providing the cone condition for $\Omega$ such that if $0<\epsilon\leq\epsilon_0$,
  $0\leq j\leq m$, and $u\in W^{m,p}(\Omega)$, then
  \begin{align}
    |u|_{j,p} & \leq K\bigl(\epsilon |u|_{m,p} + \epsilon^{-j/(m-j)}\|u\|_p\bigr), \label{eq:5.1} \\
    \|u\|_{j,p} & \leq K'\bigl(\epsilon\|u\|_{m,p} + \epsilon^{-j/(m-j)}\|u\|_p\bigr), \label{eq:5.2} \\
    \|u\|_{j,p} & \leq 2K' \|u\|_{m,p}^{j/m} \|u\|_p^{(m-j)/m}. \label{eq:5.3}
  \end{align}
\end{theorem}


\begin{para}
  Inequality~\eqref{eq:5.2} follows from repeated applications of~\eqref{eq:5.1},
  and~\eqref{eq:5.3} by setting $\epsilon_0=1$ in \eqref{eq:5.2} and choosing
  $\epsilon$ in \eqref{eq:5.2} so that the two terms on the right side are equal.
  Furthermore, \eqref{eq:5.1} holds when $\epsilon<\epsilon_0$ if it holds for
  $\epsilon<\epsilon_1$ for any specific positive $\epsilon_1$; to see this just
  replace $\epsilon$ by $\epsilon\epsilon_1/\epsilon_0$ and suitably adjust $K$.
  Thus we need only prove \eqref{eq:5.1}, and that for just one value of $\epsilon_0$.

  We carry out the proof in three lemmas. The first develops a one-dimensional
  version for the case $m=2$, $j=1$. The second establishes \eqref{eq:5.1}
  for $m=2$, $j=1$ for general $\Omega$ satisfying the cone condition. The third
  shows that \eqref{eq:5.1} is valid for general $m\geq 2$ and $1\leq j\leq m-1$
  whenever the case $m=2$, $j=1$ is known to hold.
\end{para}


\begin{lemma}
  If $\rho>0$, $1\leq p<\infty$, $K_p=2^{p-1} 9^p$, and $g\in C^2([0,\rho])$, then
  \begin{equation}\label{eq:5.4}
    |g'(0)|^p \leq \frac{K_p}{\rho} \biggl(\rho^p \int_0^\rho |g''(t)|^p
      \d t + \rho^{-p} \int_0^\rho |g(t)|^p \d t\biggr).
  \end{equation}
\end{lemma}

\begin{proof}
  Let $f\in C^2([0,1])$, let $x\in [0,1/3]$, and let $y\in [2/3,1]$.
  By the mean-value theorem there exists $z\in (x,y)$ such that
  \[ |f'(z)| = \biggl|\frac{f(y)-f(x)}{y-x}\biggr| \leq 3|f(x)| + 3|f(y)|. \]
  Thus
  \begin{align*}
    |f'(0)|
    & = \biggl|f'(z) - \int_0^z f''(t) \d t\biggr| \\
    & \leq 3|f(x)| + 3|f(y)| + \int_0^1 |f''(t)| \d t.
  \end{align*}
  Integration of $x$ over $[0,1/3]$ and $y$ over $[2/3,1]$ yields
  \[ \frac19 |f'(0)| \leq \int_0^{1/3} |f(x)| \d x
      + \int_{2/3}^1 |f(y)|\d y + \frac19 \int_0^1 |f''(t)| \d t. \]
  For $p\geq 1$ we therefore have (using H\"older's inequality if $p>1$)
  \[ |f'(0)|^p \leq K_p \biggl(\int_0^1 |f''(t)|^p \d t
      + \int_0^1 |f(t)|^p \d t\biggr), \]
  where $K_p = 2^{p-1}9^p$.

  Inequality~\eqref{eq:5.4} now follows by substituting $f(t) = g(\rho t)$.
\end{proof}


\begin{lemma}
  If $1\leq p<\infty$ and the domain $\Omega\subset\mathbb{R}^n$ satisfies
  the cone condition, then there exists a constant $K$ depending on $n$, $p$,
  and the height $\rho_0$ and aperture angle $\kappa$ of the cone $C$ providing
  the cone condition for $\Omega$ such that for all $\epsilon$, $0<\epsilon\leq\rho_0$
  and all $u\in W^{2,p}(\Omega)$ we have
  \begin{equation}\label{eq:5.5}
    |u|_{1,p} \leq K (\epsilon |u|_{2,p} + \epsilon^{-1} \|u\|_p).
  \end{equation}
\end{lemma}

\begin{proof}
  Let $\Sigma = \{\sigma\in \mathbb{R}^n : |\sigma|=1\}$ be the unit sphere
  in $\mathbb{R}^n$ with volume element $\d\sigma$ and $(n-1)$-volume
  $K_0 = K_0(n) = \int_\Sigma \d\sigma$. If $x\in\Omega$ let $\sigma_x$
  be the unit vector in the direction of the axis of a cone $C_x\subset\Omega$
  congruent to $C$ and having vertex at $x$, and let $\Sigma_x = \{\sigma\in\Sigma:
  \angle (\sigma,\sigma_x)\leq\kappa/2\}$.

  Let $u\in C^\infty(\Omega)$. If $x\in\Omega$, $\sigma\in\Sigma_x$,
  and $0<\rho\leq\rho_0$, then
  \[ |\sigma\cdot\nabla u(x)|^p \leq \frac{K_p}{\rho} I(\rho,p,u,x,\sigma), \]
  where
  \[ I(\rho,p,u,x,\sigma) = \rho^p \int_0^\rho |D_t^2 u(x+t\sigma)|^p \d t
      + \rho^{-p} \int_0^\rho |u(x+t\sigma)|^p \d t. \]
      There exists a constant $K_1=K_1(n,p,\kappa)$ such that
  \[\int_\Sigma |\sigma\cdot\nabla u(x)|^p \d\sigma
    \geq \int_{\Sigma_x} |\sigma\cdot\nabla u(x)|^p \d\sigma
    \geq K_1 |\nabla u(x)|^p.\]
  Accordingly,
  \[ \int_\Omega |\nabla u(x)|^p \d x
      \leq \frac{K_p}{K_1\rho} \int_\Sigma \d\sigma \int_\Omega I(\rho,p,u,x,\sigma) \d x. \]
  In order to estimate the inner integral on the right, regard $u$
  and its derivatives as extended to all of $\mathbb{R}^n$ so as to be
  identically zero outside $\Omega$. For simplicity, we suppose
  $\sigma = e_n = (0,\ldots,0,1)$ and write $x=(x',x_n)$ with $x'\in\mathbb{R}^{n-1}$.
  We have
  \begin{align*}
    \int_\Omega & I(\rho,p,u,x,e_n) \d x \\
    & = \int_{\mathbb{R}^{n-1}} \d x' \int_{-\infty}^\infty \d x_n
        \int_0^\rho \bigl(\rho^p |D_n^2 u(x',x_n+t)|^p + \rho^{-p} |u(x',x_n+t)|^p\bigr) \d t \\
    & = \int_{\mathbb{R}^{n-1}} \d x' \int_0^\rho \d t
        \int_{-\infty}^\infty (\rho^p |D_n^2 u(x)|^p + \rho^{-p} |u(x)|^p) \d x_n \\
    & \leq \rho \int_\Omega (\rho^p |D_n^2 u(x)|^p + \rho^{-p} |u(x)|^p) \d x.
  \end{align*}
  In general, for $\sigma\in\Sigma$
  \[ \int_\Omega I(\rho,p,u,x,\sigma) \d x \leq \rho
        \int_\Omega (\rho^p |u|_{2,p}^p + \rho^{-p}\|u\|_p^p) \d x, \]
  and since $|D_j(u)|\leq |\nabla u|$ and the measure of $\Sigma$ is $K_0$,
  \[ |u|_{1,p}^p \leq \frac{nK_pK_0}{K_1} \bigl(\rho^p |u|_{2,p}^p + \rho^{-p} \|u\|_p^p\bigr). \]
  Inequality~\eqref{eq:5.5} now follows by taking $p$th roots, replacing
  $\rho$ with $\epsilon$, and noting that $C^\infty(\Omega)$ is dense in $W^{2,p}(\Omega)$.
\end{proof}


\begin{lemma}
  Let $m\geq 2$, let $0<\delta_0<\infty$, and let
  $\epsilon_0 = \min\{\delta_0,\delta_0^2,\ldots,\delta_0^{m-1}\}$.
  Suppose that for given $p$, $1\leq p<\infty$, and given $\Omega\subset \mathbb{R}^n$
  there exists a constant $K = K(\delta_0,p,\Omega)$ such that for every $\delta$
  satisfying $0<\delta<\delta_0$ and every $u\in W^{2,p}(\Omega)$, we have
  \begin{equation}\label{eq:5.6}
    |u|_{1,p} \leq K\delta |u|_{2,p} + K\delta^{-1} |u|_{0,p}.
  \end{equation}
  Then there exists a constant $K = K(\epsilon_0,m,p,\Omega)$ such that
  for every $\epsilon$ satisfying $0<\epsilon\leq\epsilon_0$, every integer $j$
  satisfying $0\leq j\leq m-1$, and every $u\in W^{m,p}(\Omega)$, we have
  \begin{equation}\label{eq:5.7}
    |u|_{j,p} \leq K\epsilon |u|_{m,p} + K\epsilon^{-j/(m-j)} |u|_{0,p}.
  \end{equation}
\end{lemma}


\begin{proof}
  Since \eqref{eq:5.7} is trivial for $j=0$, we consider only the case $1\leq j\leq m-1$.
  The proof is accomplished by a double induction on $m$ and $j$.
  The constants $K_1$, $K_2$, $\ldots$ appearing in the argument may depend on $\delta_0$
  (or $\epsilon_0$), $m$, $p$, and $\Omega$. First we prove \eqref{eq:5.7} for $j=m-1$
  by induction on $m$, so that \eqref{eq:5.6} is the special case $m=2$. Assume, therefore,
  that for some $k$, $2\leq k\leq m-1$,
  \begin{equation}\label{eq:5.8}
    |u|_{k-1,p} \leq K_1 \delta |u|_{k,p} + K_1 \delta^{-(k-1)} |u|_{0,p}
  \end{equation}
  holds for all $\delta$, $0<\delta\leq\delta_0$, and all $u\in W^{k,p}(\Omega)$.
  If $u\in W^{k+1,p}(\Omega)$, we prove~\eqref{eq:5.8} with $k+1$ replacing $k$
  (and a different constant $K_1$). If $|\alpha|=k-1$ we obtain from~\eqref{eq:5.6}
  \[ |D^\alpha u|_{1,p} \leq K_2 \delta |D^\alpha u|_{2,p} + K_2 \delta^{-1} |D^\alpha u|_{0,p}. \]
  Combining this inequality with~\eqref{eq:5.8} we obtain, for $0<\eta\leq\delta_0$,
  \begin{align*}
    |u|_{k,p}
    & \leq K_3 \sum_{|\alpha|=k-1} |D^\alpha u|_{1,p} \\
    & \leq K_4 \delta |u|_{k+1,p} + K_4 \delta^{-1} |u|_{k-1,p} \\
    & \leq K_4 \delta |u|_{k+1,p} + K_4 K_1 \delta^{-1} \eta |u|_{k,p}
      + K_4 K_1 \delta^{-1} \eta^{1-k} |u|_{0,p}.
  \end{align*}
  We may assume without prejudice that $2K_1K_4\geq 1$. Therefore,
  we may take $\eta = \delta/(2K_1K_4)$ and so obtain
  \begin{align*}
    |u|_{k,p}
    & \leq 2 K_4 \delta |u|_{k+1,p} + \bigl(\delta / (2K_1K_4)\bigr)^{-k} |u|_{0,p} \\
    & \leq K_5 \delta |u|_{k+1,p} + K_5 \delta^{-k} |u|_{0,p}.
  \end{align*}
  This completes the induction establishing~\eqref{eq:5.8} for $0<\delta\leq\delta_0$
  and hence~\eqref{eq:5.7} for $j=m-1$ and $0<\epsilon\leq\delta_0$.

  We now prove by downward induction on $j$ that
  \begin{equation}\label{eq:5.9}
    |u|_{j,p} \leq K_6 \delta^{m-j} |u|_{m,p} + K_6 \delta^{-j} |u|_{0,p}
  \end{equation}
  holds for $1\leq j\leq m-1$ and $0<\delta\leq\delta_0$.
  Note that~\eqref{eq:5.8} with $k=m$ is the special case $j=m-1$
  of \eqref{eq:5.9}. Assume, therefore, that~\eqref{eq:5.9} holds for
  some $j$, $2\leq j\leq m-1$. We prove that it also holds with $j$
  replaced by $j-1$ (and a different constant $K_6$).
  From~\eqref{eq:5.8} and~\eqref{eq:5.9} we obtain
  \begin{align*}
    |u|_{j-1,p}
    & \leq K_7 \delta |u|_{j,p} + K_7 \delta^{1-j} |u|_{0,p} \\
    & \leq K_7 \delta \bigl(K_6 \delta^{m-j}|u|_{m,p}
      + K_6 \delta^{-j} |u|_{0,p}\bigr) + K_7 \delta^{1-j} |u|_{0,p} \\
    & \leq K_8 \delta^{m-(j-1)} |u|_{m,p} + K_8 \delta^{1-j} |u|_{0,p}.
  \end{align*}
  Thus \eqref{eq:5.9} holds, and \eqref{eq:5.7} follows by setting
  $\delta = \epsilon^{1/(m-j)}$ in~\eqref{eq:5.7} and noting that
  $\epsilon\leq\epsilon_0$ if $\delta\leq\delta_0$.
\end{proof}

This completes the proof of Theorem~5.2

\begin{remark}
  Careful consideration of the proofs of the previous two lemmas
  shows that if the height of the cone providing the cone condition
  for $\Omega$ is infinite, then inequalities~\eqref{eq:5.5}
  and~\eqref{eq:5.7} (and therefore~\eqref{eq:5.1} and~\eqref{eq:5.2})
  hold for all $\epsilon>0$, the corresponding constants $K$
  being independent of $\epsilon$. This is the case, for example,
  if $\Omega=\mathbb{R}^n$ or a half-space like $\mathbb{R}^n_+$.
\end{remark}


\section{Interpolation on Degree of Summability}

The following two interpolation theorems provide sharp estimates
for $L^q$ norms of functions in $W^{m,p}(\Omega)$. Some of these
estimates follow from Theorem~4.12 while others have traditionally
been obtained for regular domains from inbeddings of Sobolev
spaces of fractional order. (See Chapter~7.) We obtain them here
assuming only that the domain satisfies the cone condition. Again,
the weak cone condition would do as well; see [AF1].

\begin{theorem}
  Let $\Omega$ be a domain in $\mathbb{R}^n$ satisfying the cone
  condition. If $mp>n$, let $p\leq q\leq\infty$; if $mp=n$,
  let $p\leq q<\infty$; if $mp<n$, let $p\leq q\leq p^*=np/(n-mp)$.
  Then there exists a constant $K$ depending on $m,n,p,q$ and the
  dimensions of the cone $C$ providing the cone condition for $\Omega$,
  such that for all $u\in W^{m,p}(\Omega)$,
  \begin{equation}\label{eq:5.10}
    \|u\|_q \leq K \|u\|_{m,p}^\theta \|u\|_p^{1-\theta},
  \end{equation}
  where $\theta = (n/mp) - (n/mq)$.
\end{theorem}

\begin{proof}
  The case $mp<n$, $p\leq q\leq p^*$ follows directly from Theorems~2.11
  and~4.12:
  \[ \|u\|_q \leq \|u\|_{p^*}^\theta \|u\|_p^{1-\theta}
      \leq K\|u\|_{m,p}^\theta \|u\|_p^{1-\theta}, \]
  where $1/q = (\theta/p^*) + (1-\theta)/p$ from which it follows that
  $\theta = (n/mp) - (n/mq)$. For the cases $mp=n$, $p\leq q<\infty$,
  and $mp>n$, $p\leq q\leq\infty$ we use the local bound obtained in Lemma~4.15.
  If $0<r\leq\rho$ (the height of the cone $C$), then
  \begin{equation}\label{eq:5.11}
    |u(x)| \leq K_1 \biggl(\sum_{|\alpha|\leq m-1} r^{|\alpha|-n} \chi_r * |D^\alpha u|(x)
      + \sum_{|\alpha|=m} (\chi_r\omega_m)*|D^\alpha u|(x)\biggr),
  \end{equation}
  where $\chi_r$ is the characteristic function of the ball of radius $r$
  centred at the origin in $\mathbb{R}^n$, and $\omega_m(x) = |x|^{m-n}$.
  We estimate the $L^q$ norms of both terms on the right side of~\eqref{eq:5.11}
  using Young's inequality from Corollary~2.25. If $(1/p)+(1/s) = 1+(1/q)$, then
  \begin{align*}
    \|\chi_r * |D^\alpha u|\|_q
    & \leq \|\chi_r\|_s \|D^\alpha u\|_p = K_2 r^{n-(n/p)+(n/q)} \|D^\alpha u\|_p \\
      \|(\chi_r\omega_m) * |D^\alpha u|\|_q
    & \leq \|\chi_r\omega_m\|_s \|D^\alpha u\|_p = K_3 r^{m-(n/p)+(n/q)} \|D^\alpha u\|_p.
  \end{align*}
  (Note that $m-(n/p)+(n/q)>0$ if $q$ satisfies the above restrictions.) Hence
  \[ \|u\|_q \leq K_4 \biggl(\sum_{j=0}^{m-1} r^{j-(n/p)+(n/q)} |u|_{j,p}
      + r^{m-(n/p)+(n/q)} |u|_{m,p}\biggr). \]
  By Theorem~5.2,
  \[ |u|_{j,p} \leq K_5 (r^{m-j} |u|_{m,p} + r^{-j} \|u\|_p), \]
  so
  \[ \|u\|_q \leq K_6 \bigl(r^{m-(n/p)+(n/q)} \|u\|_{m,p}
      + r^{-(n/p+(n/q))} \|u\|_p\bigr). \]
  Adjusting $K_6$ if necessary, we can assume this inequality holds for all $r\leq 1$.
  Choosing $r$ to make the two terms on the right side equal, we obtain~\eqref{eq:5.10}.
\end{proof}

A special case of the above Theorem asserts that if $mp>n$, then
\begin{equation}\label{eq:5.12}
  \|u\|_\infty \leq K \|u\|_{m,p}^{n/mp} \|u\|_p^{1-(n/mp)}.
\end{equation}
A similar inequality with $\|u\|_p$ replaced by a more general $\|u\|_q$
is sometimes useful.

\begin{theorem}
  Let $\Omega$ be a domain in $\mathbb{R}^n$ satisfying the cone condition.
  Let $p>1$ and $mp>n$. Suppose that either $1\leq q\leq p$ or both $q>p$
  and $mp-p<n$. Then there exists a constant $K$ depending on $m$, $n$, $p$,
  $q$ and the dimensions of the cone $C$ providing the cone condition for
  $\Omega$, such that for all $u\in W^{m,p}(\Omega)$,
  \[ \|u\|_\infty \leq K\|u\|_{m,p}^\theta \|u\|_q^{1-\theta}, \]
  where $\theta = np/[np+(mp-n)q]$.
\end{theorem}

\begin{proof}
  It is sufficient to show that the inequality
  \begin{equation}\label{eq:5.13}
    |u(x)|\leq K\|u\|_{m,p}^\theta \|u\|_q^{1-\theta},
      \qquad \theta = np/[np+(mp-q)q]
  \end{equation}
  holds for all $x\in\Omega$ and all $u\in W^{m,p}(\Omega)\cap C^\infty(\Omega)$.

  First we observe that~\eqref{eq:5.13} is a straightforward consequence
  of Theorems~5.8 and~2.11 if $1\leq q\leq p$; since~\eqref{eq:5.12} holds
  we can substitute
  \[ \|u\|_p \leq \|u\|_q^{q/p} \|u\|_{\infty}^{1-(q/p)} \]
  and obtain~\eqref{eq:5.13} by cancellation.

  Now suppose $q>p$. and, for the moment, that $m=1$ and $p>n$. We reuse
  the local bound~\eqref{eq:5.11}; in this case it says
  \[ |u(x)| \leq K_1 \biggl( r^{-n} \chi_r * |u|(x) 
      + \sum_{|\alpha|=1} (\chi_r\omega_1) * |D^\alpha u|(x)\biggr), \]
  for $0<r\leq\rho$, the height of the cone $C$. By H\"older's inequality,
  \[ \chi_r * |u|(x) \leq K_2 r^{n-(n/q)} \|u\|_q, \]
  and, for $|\alpha|=1$,
  \begin{equation}\label{eq:5.14}
    (\chi_r\omega_1) * |D^\alpha u|(x) \leq K_3 r^{1-(n/p)} \|D^\alpha u\|_p.
  \end{equation}
  Since $\|u\|_q \leq K_5 \|u\|_{1,p}$ (by Part I Case A of Theorem~4.12),
  and since inequality~\eqref{eq:5.14} may be assumed to hold for all $r$
  such that $0<r^{1-(n/p)+(n/q)}\leq K_5$ provided $K_4$ is suitably adjusted,
  we can choose $r$ to make the two upper bounds above equal. This choice yields~\eqref{eq:5.13}
  with $m=1$.

  For general $m$, we have $W^{m,p}(\Omega) \to W^{1,r}(\Omega)$, where
  $r = np/(n-mp+p)$ satisfies $n<r<\infty$ since $(m-1)p<n<mp$. Hence,
  if $u\in W^{m,p}(\Omega)\cap C^\infty(\Omega)$, we have
  \[ |u(x)| \leq K_6 \|u\|_{1,r}^\theta \|u\|_q^{1-\theta} 
      \leq K_7 \|u\|_{m,p}^\theta \|u\|_q^{1-\theta}, \]
  where $\theta = nr/[nr+(r-n)q] = np/[np+(mp-n)q]$.
\end{proof}


The following theorem makes use of the above result to provide an alternate
direct proof of Part I Case C of the Sobolev imbedding theorem~4.12 as well
as a hybrid imbedding inequality that will prove useful for establishing
compactness of some of these imbeddings in the next chapter.

\begin{theorem}
  Let $\Omega$ be a domain in $\mathbb{R}^n$ satisfying the cone condition.
  Let $m$ and $k$ be positive integers and let $p>1$. Suppose that $mp<n$
  and $n-mp<k\leq n$. Let $\nu$ be the largest integer less than $mp$, so
  that $n-\nu\leq k$. Let $\Omega_k$ be the intersection of $\Omega$ with
  a $k$-dimensional plane in $\mathbb{R}^n$. Then there exists a constant
  $K$ such that the inequality
  \begin{equation}\label{eq:5.15}
    \|u\|_{0,kq/n,\Omega_k} \leq K \|u\|_{0,q,\Omega}^{1-\theta}
      \|u\|_{m,p,\Omega}^\theta
  \end{equation}
  holds for all $u\in W^{m,p}(\Omega)$, where
  \[ q = p^* = \frac{np}{n-mp} \quad \text{and} \quad
      \theta = \frac{\nu p}{\nu p + (mp-\nu)q}. \]
  Note that $0<\theta<1$.
\end{theorem}

\begin{proof}
  Again it is sufficient to establish the inequality for functions
  in $W^{m,p}(\Omega)\cap C^\infty(\Omega)$. Without loss of generality
  we may assume that $H$ is a coordinate $k$-plane $\mathbb{R}^k$ in
  $\mathbb{R}^n$, and, as we did in Lemma~4.24, that $\omega$ is a union
  of coordinate cubes of fixed edge length, say 2.

  Let $\mu = \binom{k}{n-\nu}$, and let $E^i$, $1\leq i\leq\mu$, denote
  the various coordinate planes in $\mathbb{R}^k$ having dimension $n-\nu$.
  Let $\Omega^i$ be the projection of $\Omega_k$ onto $E^i$, and for each
  $x\in\Omega^i$ let $\Omega_x^i$ denote the intersection of $\Omega$
  with the $\nu$-dimensional plane through $x$ perpendicular to $E^i$.
  Then $\Omega_x^i$ contains a $\nu$ dimensional cube of unit edge length
  having a vertex at $x$, so it satisfies a cone condition with parameters
  independent of $i$ and $x$. By Theorem~5.9
  \[ \|u\|_{0,\infty,\Omega_x^i} \leq K \|u\|_{0,q,\Omega_x^i}^{1-\theta}
      \|u\|_{m,p,\Omega_x^i}^\theta. \]
  Let $s = (n-\nu)p/(n-mp)$, and let $\d x^i$ and $\d x_*^i$ denote the volume
  elements in $E^i$ and its orthogonal complement (in $\mathbb{R}^n$) respectively.
  Since
  \[ s(1-\theta) = \frac{q(mp-\nu)}{mp} \quad \text{and} \quad s\theta = \frac{\nu}{m}, \]
  we have
  \begin{align*}
    & \int_{\Omega^i} \sup_{y\in\Omega_x^i} |u(u)|^s \d x^i \\
    & \leq K_1 \int_{\Omega^i} \biggl[\int_{\Omega_x^i} |u(x)|^q \d x_*^i\biggr]^{(mp-\nu)/mp}
      \Biggl[\int_{\Omega_x^i} \sum_{|\alpha|\leq m} |D^\alpha u(x)|^p \d x_*^i\Biggr]^{\nu/mp} \\
    & \leq K_1 \|u\|_{0,q,\Omega}^{s(1-\theta)} \|u\|_{m,p,\Omega}^{s\theta},
  \end{align*}
  the last line beging an application of H\"older's inequality.

  Let $\d x^k$ denote the $k$-dimensional volume element in $H$.
  We apply the averaging Lemma~4.23 to the family of $\mu$ subspaces $E^i$
  of $\mathbb{R}^k$. The parameter $\lambda$ for this application of the lemma
  is $\lambda = \binom{k-1}{n-\nu-1} = (n-\nu)\mu/k$. Since $(kq/n)(\lambda/\mu)=s$,
  we obtain
  \begin{align*}
    \|u\|_{0,kq/n,\Omega_k}^{kq/n}
    & \leq K_2 \int_{\Omega_k} \prod_{i=1}^\mu \sup_{y\in \Omega_x^i} |u(y)|^{kq/\nu n} \d x^k \\
    & \leq K_2 \prod_{i=1}^\mu \Biggl[\int_{\Omega^i} \sup_{y\in\Omega_x^i} |u(y)|^s \d x^i\Biggr]^{1/\lambda} \\
    & \leq K_3 \prod_{i=1}^\mu \|u\|_{0,q,\Omega}^{kq(1-\theta)/\nu n} \|u\|_{m,p,\Omega}^{kq\theta/\nu n},
  \end{align*}
  so that
  \[ \|u\|_{0,kq/n,\Omega_k} \leq K \|u\|_{0,q,\Omega}^{1-\theta} \|u\|_{m,p,\Omega}^\theta \]
  as required.
\end{proof}


\begin{remark}
  If we take $k=n$ in equality~\eqref{eq:5.15}, then the imbedding $W^{m,p}(\Omega)\to L^q(\Omega)$
  follows for $q = np/(n-mp)$ by cancellation. The corresponding imbedding inequality
  $\|u\|_{0,q,\Omega} \leq K\|u\|_{m,p,\Omega}$ can then be used to further
  estimate the right side of~\eqref{eq:5.15}, yielding the trace imbedding
  $W^{m,p}(\Omega) \to L^r(\Omega_k)$ for $r = kp/(n-mp)$.
\end{remark}


\section{Interpolation Involving Compact Subdomains}

Sometimes it is useful to have bounds for intermediate derivatives $D^\beta u$,
of a function $u\in W^{m,p}(\Omega)$, where $1\leq |\beta|\leq m-1$,
in terms of the seminorm $|u|_{m,p,\Omega}$ and the $L^p$-norm of $u$
over a compact subdomain $\Omega'\subset\subset\Omega$. Such inequalities
are typically not possible unless $\Omega$ is bounded, but for bounded $\Omega$
they can be estimated under the assumption that $\Omega$ satisfies either the
segment condition or the cone condition. (A bounded domain $\Omega$
satisfying the cone condition can be decomposed into a finite union of
subdomains each of which satisfies the strong local Lipschitz condition,
and therefore the segment condition. See Lemma~4.22.) We will prove the
following hybrid interpolation theorem. (See Agmon [Ag].)

\begin{theorem}
  Let $\Omega$ be a bounded domain in $\mathbb{R}^n$ satisfying the segment
  condition. Let $0<\epsilon_0<\infty$, let $1\leq p<\infty$, and let $j$
  and $m$ be integers with $0\leq j\leq m-1$. There exists a constant
  $K = K(\epsilon_0,m,p,\Omega)$ and for each $\epsilon$ satisfying
  $0<\epsilon\leq\epsilon_0$ a domain $\Omega_\epsilon\subset\subset\Omega$
  such that for every $u\in W^{m,p}(\Omega)$
  \begin{equation}\label{eq:5.16}
    |u|_{j,p,\Omega} \leq K\epsilon |u|_{m,p,\Omega} + K\epsilon^{-j/(m-j)} \|u|_{p,\Omega_\epsilon}.
  \end{equation}
\end{theorem}

Note that this theorem implies Theorem~5.2 extends to bounded domains satisfying
the segment condition.

As in the proof of Theorem~5.12, we begin with a one-dimensional inequality.

\begin{lemma}
  Let $1\leq p<\infty$ and let $0<l_1<l_2<\infty$. Then there exists a constant
  $K = K(p,l_1,l_2)$ and, for every $\epsilon>0$, a number $\delta = \delta(\epsilon,l_1,l_2)$
  satisfying $0<2\delta<l_1$ such that if $(a,b)$ is a finite open interval
  in $\mathbb{R}$ whose length $b-a$ satisfies $l_1\leq b-1\leq l_2$, and
  $g\in C^1(a,b)$, then
  \begin{equation}\label{eq:5.17}
    \int_a^b |g(t)|^p \d t \leq K\epsilon \int_a^b |g'(t)|^p \d t
      + K \int_{a+\delta}^{b-\delta} |g(t)|^p \d t.
  \end{equation}
\end{lemma}

\begin{proof}
  If $f\in C^1(0,1)$, $0<t<1$, and $1/3<\tau<2/3$, then
  \[ |f(s)| = \biggl|f(\tau) + \int_{\tau}^s f'(\xi) \d\xi\biggr|
      \leq |f(\tau)| + \int_0^1 |f'(\xi)| \d\xi. \]
  Integrating $\tau$ over $(1/3,2/3)$, applying H\"older's inequality
  if $p>1$, and finally integrating $s$ over $(0,1)$ gives
  \[ \int_0^1 |f(s)|^p \leq K_p \int_{1/3}^{2/3} |f(s)|^p \d s
      + K_p \int_0^1 |f'(s)|^p \d s, \]
  where $K_p = 3\cdot 2^{p-1}$. Now substitute $f(s) = g\bigl(a+s(b-a)\bigr)=g(t)$
  to obtain
  \[ \int_a^b |g(t)|^p \leq K_p (b-a)^p \int_a^b |g'(t)|^p \d t
      + K_p \int_{(2a+b)/3}^{(a+2b)/3} |g(t)|^p \d t. \]
  For given $\epsilon>0$ pick a positive integer $k$ such that $k^{-p}\leq\epsilon$.
  Let $a_j = a+(b-a)j/k$ for $j=0,1,\ldots,k$ and pick $\delta$ so that
  $0<\delta\leq (b-a)/3k$. Then
  \begin{align*}
    \int_a^b |g(t)|^p \d t
    & = \sum_{j=1}^k \int_{a_{j-1}}^{a_j} |g(t)|^p \d t \\
    & \leq K_p \sum_{j=1}^k \Biggl[\biggl(\frac{b-a}{k}\biggr)^p \int_{a_{j-1}}^{a_j}
        |g'(t)|^p \d t + \int_{a_{j-1}+\delta}^{a_j-\delta} |g(t)|^p \d t\Biggr] \\
    & \leq K_p \max\{1,(b-a)^p\} \biggl[\epsilon \int_a^b |g'(t)|^p \d t
        + \int_{a+\delta}^{b-\delta} |g(t)|^p \d t\biggr]
  \end{align*}
  which is the desired inequality~\eqref{eq:5.17}.
\end{proof}


\begin{lemma}
  Let $\Omega$ be a bounded domain in $\mathbb{R}^n$ that satisfies the segment
  condition. Then there exists a constant $K=K(p,\Omega)$ and, for any positive
  number $\epsilon$, a domain $\Omega_{\epsilon}\subset\subset\Omega$, such that
  \begin{equation}\label{eq:5.18}
    |u|_{0,p,\Omega} \leq K\epsilon |u|_{1,p,\Omega} + K |u|_{0,p,\Omega_{\epsilon}}
  \end{equation}
  holds for every $u\in W^{1,p}(\Omega)$.
\end{lemma}

\begin{proof}
  Since $\Omega$ is bounded, and its boundary is therefore compact, the open
  cover $\{U_j\}$ of $\partial\Omega$ and corresponding set $\{y_j\}$ of
  nonzero vectors referred to in the definition of the segment condition
  (Paragraph~3.21) are both finite sets. Therefore open sets $V_j\subset\subset U_j$
  can be found such that $\partial\Omega\subset\bigcup_j V_j$ and even,
  for sufficiently small $\delta$, $\Omega_\delta = \{x\in\Omega : \dist(x,\partial\Omega)<\delta\}
  \subset \bigcup_j V_j$. Thus $\Omega = \bigcup_j (V_j\cap\Omega)\cup\tilde{\Omega}$,
  where $\tilde{\Omega}\subset\subset\Omega$. It is thus sufficient
  to prove that for each $j$
  \[ |u|_{0,p,V_j\cap\Omega^p} \leq K_1 \epsilon^p |u|_{1,p,\Omega}^p
      + K_1 |u|_{0,p,\Omega_{\epsilon,j}} \]
  for some $\Omega_{\epsilon,j}\subset\subset\Omega$. For simplicity,
  we now drop the subscripts $j$.

  Consider the sets $Q$, $Q_\eta$, $0\leq\eta\leq 1$, defined by
  \begin{align*}
    Q & = \{x+ty : x\in U\cup\Omega, 0<t<1\}, \\
    Q_\eta & = \{x+ty : x\in V\cap\Omega, \eta<t<1\}.
  \end{align*}
  If $\eta>0$, then $Q_\eta\subset\subset Q$, and by the segment condition,
  $Q\subset\Omega$. Any line $\ell$ parallel to $y$ and passing through
  a point in $V\cap\Omega$ intersects $Q_0$ in one or more intervals
  each having length between $|y|$ and the $\diam\Omega$. By~\eqref{eq:5.13}
  there exists $\eta>0$ and a constant $K_1$ such that for every $u\in C^\infty(\Omega)$
  and any such line $\ell$
  \[ \int_{\ell\cap\Omega_0} |u(x)|^p \d s
      \leq K_1 \epsilon^p \int_{\ell\cap\Omega_0} |D_y u(x)|^p \d s
      + K_1 \int_{\ell\cap\Omega_\eta} |u(x)|^p \d s, \]
  $D_y$ denoting differentiation in the direction of $y$ and $\d s$ being the
  length element in that direction. We integrate this inequality over the
  projection of $Q_0$ on a hyperplane perpendicular to $y$ and so obtain
  \begin{align*}
    |u|_{0,p,V\cap\Omega}^p \leq |u|_{0,p,Q_0}^p
    & \leq K_1 \epsilon^p |u|_{1,p,Q_0}^p + K_1 |u|_{0,p,Q_\eta}^p \\
    & \leq K_1 \epsilon^p |u|_{1,p,\Omega}^p + K_1 |u|_{0,p,Q_\epsilon}^p,
  \end{align*}
  where $\Omega_\epsilon = \Omega_\eta \subset\subset\Omega$.
  By density, this inequality holds for every $u\in W^{1,p}(\Omega)$.
\end{proof}


\begin{para}[Completion of the Proof of Theorem 5.12]
  We apply Lemma~5.14 to derivatives $D^\beta u$, $|\beta|=m-1$ to obtain
  \begin{equation}\label{eq:5.19}
    |u|_{m-1,p,\Omega} \leq K\epsilon |u|_{m,p,\Omega} + K_1 |u|_{m-1,p,\Omega_\epsilon},
  \end{equation}
  where $\Omega_{\epsilon}\subset\subset\Omega$. Since $\overline{\Omega_{\epsilon}}$
  is a compact subset of $\Omega$, there exists a constant $\delta>0$ such that
  $\dist(\overline{\Omega_{\epsilon}}, \partial\Omega) > \delta$. The union $\Omega'$
  of open balls of radius $\delta$ about points in $\overline{\Omega_{\epsilon}}$
  clearly satisfies the cone condition and also $\Omega'\subset\subset\Omega$. We can
  use $\Omega'$ in place of $\Omega_{\epsilon}$ in~\eqref{eq:5.19}, and so we can
  assume $\Omega_{\epsilon}$ satisfies the cone condition. By Theorem~5.2, for given
  $\epsilon_0>0$ the inequality
  \[ |u|_{m-1,p,\Omega_{\epsilon}} \leq K_2 \epsilon |u|_{m,p,\Omega_{\epsilon}}
      + K_2 \epsilon^{-(m-1)} |u|_{0,p,\Omega_{\epsilon}}. \]
  Combining this with inequality~\eqref{eq:5.19} we obtain the case $j=m-1$
  of~\eqref{eq:5.16}.

  The rest of the proof is by downward induction on $j$. Assuming that~\eqref{eq:5.16}
  holds for some $j$ satisfying $1\leq j\leq m-1$, and replacing $\epsilon$
  with $\epsilon^{m-j}$ (with consequent alternations to $K$ and $\Omega_\epsilon$),
  we obtain
  \[ |u|_{j,p,\Omega} \leq K_3 \epsilon^{m-j} |u|_{m,p,\Omega} 
      + K_3 \epsilon^{-j} |u|_{0,p,\Omega_{\epsilon,1}}. \]
  Also, by the case already proved,
  \[ |u|_{j-1,p,\Omega} \leq K_4 \epsilon |u|_{j,p,\Omega}
      + K_4 \epsilon^{-(j-1)} |u|_{0,p,\Omega_{\epsilon,2}}. \]
  Combining these we get
  \[ |u|_{j-1,p,\Omega} \leq K_5 \epsilon^{m-(j-1)} |u|_{m,p,\Omega}
      + K_5 \epsilon^{-(j-1)} |u|_{0,p,\Omega_{\epsilon}}, \]
  where $K_5 = K_4(K_3+1)$ and $\Omega_{\epsilon} = \Omega_{\epsilon,1} \cup \Omega_{\epsilon,2}$.
  Replacing $\epsilon$ by $\epsilon^{1/(m-j+1)}$ we complete the induction.
\end{para}


\begin{remark}
  The conclusion of Theorem~5.12 is also valid for bounded domains satisfying
  the cone condition. Although the cone condition does not imply the segment
  condition, the decomposition of a domain $\Omega$ satisfying the cone condition
  into a finite union of subdomains each of which is a union of parallel
  translates of a parallelepiped (see Lemma~4.22) can be refined, for bounded
  $\Omega$, so that each of the subdomains satisfies a strong local Lipschitz
  condition and therefore also the segment condition.
\end{remark}


\section{Extension Theorems}

\begin{para}[Extension Operators]
  Let $\Omega$ be a domain in $\mathbb{R}^n$. For given $m$ and $p$ a linear
  operator $E$ mapping $W^{m,p}(\Omega)$ into $W^{m,p}(\mathbb{R}^n)$ is called
  a \emph{simple $(m,p)$-extension operator for $\Omega$} if there exists a
  constant $K=K(m,p)$ such that for every $u\in W^{m,p}(\Omega)$ the following
  conditions hold:
  \begin{enumerate}[(i)]
    \item $Eu(x) = u(x)$ a.e.~in $\Omega$,
    \item $\|Eu\|_{m,p,R^n} \leq K \|u\|_{m,p,\Omega}$.
  \end{enumerate}
  $E$ is called a \emph{strong $m$-extension operator for $\Omega$} if $E$
  is a linear operator mapping functions defined a.e.~in $\Omega$ to functions
  defined a.e.~in $\mathbb{R}^n$ and if, for every $p$, $1\leq p<\infty$,
  and every integer $k$, $0\leq k\leq m$, the restriction of $E$ to
  $W^{k,p}(\Omega)$ is a simple $(k,p)$-extension operator for $\Omega$.

  Finally, $E$ is called a \emph{total extension operator for $\Omega$}
  if $E$ is a strong $m$-extension operator for $\Omega$ for every $m$.
  Such a total extension operator necessarily extends functions in
  $C^m(\overline{\Omega})$ to lie in $C^m(\mathbb{R}^n)$.
\end{para}


\begin{para}
  The existence of even a simple $(m,p)$-extension operator for $\Omega$
  guarantees that $W^{m,p}(\Omega)$ inherits many properties possessed by
  $W^{m,p}(\mathbb{R}^n)$. For instance, if an imbedding $W^{m,p}(\mathbb{R}^n)
  \to L^q(\mathbb{R}^n)$ is known to hold, so that
  \[ \|u\|_{q,\mathbb{R}^n} \leq K_1 \|u\|_{m,p,\mathbb{R}^n}, \]
  then the imbedding $W^{m,p}(\Omega)\to L^q(\Omega)$ must also hold,
  for if $u\in W^{m,p}(\Omega)$, then
  \[ \|u\|_{0,q,\Omega} \leq \|Eu\|_{0,q,\mathbb{R}^n} \leq K_1 \|Eu\|_{m,p, \mathbb{R}^n}
      \leq K_1 K \|u\|_{m,p,\Omega}. \]
  The reason we did not use this technique to prove the Sobolev imbedding
  theorem~4.12 is that extension theorems cannot be obtained for some domains
  satisfying such weak conditions as the cone condition or even the weak cone
  condition.

  We will construct extension operators of each of the three types defined above.
  First we will use successive reflections in smooth boundaries to construct
  strong and total extension operators for half spaces, and strong extension
  operators for domains with suitably smooth boundaries. The method is attributed
  to Whitney [W] and later Hestenes [He] and Seeley [Se]. Stein [St] obtained
  a total extension operator under the minimal assumption that $\Omega$
  satisfies the strong local Lipschitz condition. He used integral averaging instead
  of reflections. We will give only an outline of his proof here, leaving the
  interested reader to consult [St] for the details. See also [Ry]. The third
  construction, due to Calder\'on [Ca1] involves the use of the Calder\'on-Zygmund
  theory of singular integrals. It is less transparent than the reflection or
  averaging methods, and only works when $1<p<\infty$, but requires only that the
  domain $\Omega$ satisfies the uniform cone condition. Unlike the other methods,
  it has the property that if the trivial extension $\tilde u$ belongs to
  $W^{m,p}(\mathbb{R}^n)$, then $\tilde u$ is the extension produced by the method.
  By Theorem~5.29 below, this happens if and only if $u\in W_0^{m,p}(\Omega)$.
  The paper [Jn] provides an extension method that works under a geometric hypothesis
  that is necessary and sufficient in $\mathbb{R}^2$, and is nearly optimal in
  higher dimensions.

  Except for very simple domains all of our constructions require the use of
  partitions of unity subordinate to open covers of $\partial\Omega$ chosen
  in such a way that the functions in the partition have uniformly bounded
  derivatives.

  To illustrate the reflection technique we begin by constructing a strong
  $m$-extension operator and a total extension operator for a half-space.
  Then we extend these to apply to domains that satisfy the uniform $C^m$-regularity
  condition and also have a bounded boundary.
\end{para}

\begin{theorem}
  Let $\Omega$ be the half-space $\mathbb{R}^n_+ = \{x\in \mathbb{R}^n: x_n>0\}$.
  Then there exists a strong $m$-extension operator $E$ for $\Omega$.
  Moreover, for every multiindex $\alpha$ satisfying $|\alpha|\leq m$ there exists
  a strong $(m-|\alpha|)$-extension operator $E_\alpha$ for $\Omega$, such that
  \[ D^\alpha Eu(x) = E_\alpha D^\alpha u(x). \]
\end{theorem}

\begin{proof}
  For functions $u$ defined a.e.~on $\mathbb{R}^n_+$ we define $Eu$ and $E_\alpha u$,
  $|\alpha|\leq m$ a.e.\ on $rn$ via
  \begin{align*}
    Eu(x) & = \begin{cases}
                u(x) & \text{if}\ x_n>0 \\
                \sum_{j=1}^[m+1] \lambda_j u(x_1,\ldots,x_{n-1},-jx_n) & \text{if}\ x_n<0,
              \end{cases} \\
    E_\alpha u(x)
          & = \begin{cases}
                u(x) & \text{if}\ x_n>0 \\
                \sum_{j=1}^{m+1} (-j)^{\alpha_n} \lambda_j u(x_1,\ldots,x_{n-1},-jx_n) & \text{if}\ x_n<0,
              \end{cases}
  \end{align*}
  where the coefficients $\lambda_1,\ldots,\lambda_{m+1}$ are the unique solutions
  of the $(m+1)\times (m+1)$ system of linear equations
  \[ \sum_{j=1}^{m+1} (-j)^k \lambda_j = 1, \qquad k = 0,\ldots,m. \]
  If $u\in C^m(\overline{\mathbb{R}^n_+})$, it is readily checked that
  $Eu\in C^m(\mathbb{R}^n)$ and
  \[ D^\alpha Eu(x) = E_\alpha D^\alpha u(x), \qquad |\alpha|\leq m. \]
  Thus
  \begin{align*}
    & \int_{\mathbb{R}^n} |D^\alpha Eu(x)|^p \d x \\
    & = \int_{\mathbb{R}^n_+} |D^\alpha u(x)|^p \d x
        + \int_{\mathbb{R}^n_-} \Biggl|\sum_{j=1}^{m+1} (-j)^{\alpha_n} \lambda_j
          u(x_1,\ldots,x_{n-1},-jx_n)\Biggr|^p \d x \\
    & \leq K(m,p,\alpha) \int_{\mathbb{R}^n_+} |D^\alpha u(x)|^p \d x.
  \end{align*}
  By Theorem~3.22, the above inequality extends to functions
  $u\in W^{k,p}(\mathbb{R}^n_+)$, $m\geq k\geq |\alpha|$. Hence,
  $E$ is a strong $m$-extension operator for $\mathbb{R}^n_+$.
  Since $D^\beta E_\alpha u(x) = E_{\alpha+\beta}u(x)$, a similar
  calculation shows that $E_\alpha$ is a strong $(m-|\alpha|)$-extension.
\end{proof}

The reflection technique used in the above proof can be modified to yield
a total extension operator. The proof, due to Seeley [Se], is based on the 
following lemma.

\begin{lemma}
  There exists a sequence $\{a_k\}_{k=0}^\infty$ such that for every
  nonnegative integer $n$ we have
  \begin{equation}\label{eq:5.20}
    \sum_{k=0}^\infty 2^{nk} a_k = (-1)^n,
  \end{equation}
  and
  \begin{equation}\label{eq:5.21}
    \sum_{k=0}^\infty 2^{nk} |a_k| < \infty.
  \end{equation}
\end{lemma}

\begin{proof}
  For fixed $N$, let $a_{k,N}$, $k=0,1,\ldots,N$ be the solution of
  the system of linear equations
  \begin{equation}\label{eq:5.22}
    \sum_{k=0}^N 2^{nk} a_{k,N} = (-1)^n, \qquad n=0,1,\ldots,N.
  \end{equation}
  In terms of the Vandermonde determinant
  \[ V(x_0,x_1,\ldots,x_N) = 
     \begin{vmatrix}
      1      & 1      & \cdots & 1      \\
      x_0    & x_1    & \cdots & x_N    \\
      x_0^2  & x_1^2  & \cdots & x_N^2  \\
      \vdots & \vdots &        & \vdots \\
      x_0^N  & x_1^N  & \cdots & x_N^N  \\
     \end{vmatrix}
     = \prod_{\substack{i,j=0 \\ i<j}}^N (x_j - x_i), \]
  $a_{k,N}$ as given by Cramer's rule is
  \begin{align*}
    a_{k,N}
    & = \frac{V(1,2,\ldots,2^{k-1},-1,2^{k+1},\ldots,2^N)}{V(1,2,\ldots,2^N)} \\
    & = \left[\prod_{\substack{i,j=0 \\ i,j\neq k \\ i<j}} (2^j-2^i)
               \prod_{i=0}^{k-1} (-1-2^i)
               \prod_{j=k+1}^N (2^j+1)\right] \cdot
        \left[\prod_{\substack{i,j=0 \\ i<j}}^N (2^j-2^i)\right]^{-1} \\
    & = A_k B_{k,N}
  \end{align*}
  where
  \[ A_K = \prod_{i=1}^{k-1} \frac{1+2^i}{2^i-2^k}, \qquad 
     B_{k,N} = \prod_{j=k+1}^N \frac{1+2^j}{2^j-2^k}, \]
  it being understood that $\prod_{i=1}^m P_i = 1$ if $l>m$. Now
  \[ |A_k| \leq \prod_{i=1}^{k-1} \frac{2^{i+1}}{2^{k-1}} \leq 2^{(5k-k^2)/2}. \]
  Also
  \begin{align*}
    \log B_{k,N}
    & = \sum_{j=k+1}^N \log \biggl(1 + \frac{1+2^k}{2^j-2^k}\biggr) \\
    & < \sum_{j=k+1}^N \frac{1+2^k}{2^j-2^k}
      < (1+2^k) \sum_{j=k+1}^N \frac{1}{2^{j-1}} < 4,
  \end{align*}
  where we have used the inequality $\log(1+x) < x$ valid for $x>0$.
  It follows that the increasing sequence $\{B_{k,N}\}_{N=0}^\infty$
  converges to a limit $B_k\leq e^4$. Let $a_k = A_k B_k$, so that
  \[ |a_k| \leq e^4 \cdot 2^{(5k-k^2)/2}. \]
  Then for any $n$
  \[ \sum_{k=0}^\infty 2^{nk} |a_k| \leq e^4 \sum_{k=0}^\infty 2^{(2nk+5k-k^2)/2} < \infty. \]
  Letting $n\to\infty$ in \eqref{eq:5.22} completes the proof.
\end{proof}


\begin{theorem}
  Let $\Omega$ be a half-space in $\mathbb{R}^n$. Then there exists a total
  extension operator $E$ for $\Omega$.
\end{theorem}

\begin{proof}
  The restrictions to $\mathbb{R}^n_+$ of functions $\phi\in C_0^\infty(\mathbb{R}^n)$
  being dense in $W^{m,p}(\mathbb{R}^n_+)$ for any $m$ and $p$, we need only
  define the extension operator for such functions. Let $f$ be a real-valued
  function, infinitely differentiable on $[0,\infty)$ and satisfying
  $f(t)=1$ if $0\leq t\leq 1/2$ and $f(t)=0$ if $t\geq 1$.
  If $\phi\in C_0^\infty(\mathbb{R}^n)$, let
  \[ E\phi(x) = E\phi(x',x_n) = 
      \begin{cases}
        \phi(x), & \text{if}\ x_n\geq 0, \\
        \sum_{k=0}^\infty a_k f(-2^k x_n) \phi(x',-2^k x_n) & \text{if}\ x_n<0,
      \end{cases}\]
  where $\{a_k\}$ is the sequence constructed in the previous lemma.
  $E\phi$ is well-defined on $\mathbb{R}^n$ since the sum above has only
  finitely many nonvanishing terms for any particular
  $x\in \mathbb{R}^n_- = \{x\in \mathbb{R}^n : x_n<0\}$.
  Moreover, $E\phi$ has compact support and belongs to
  $C^\infty(\overline{\mathbb{R}^n_+}) \cap C^\infty(\overline{\mathbb{R}^n_-})$.
  If $x\in \mathbb{R}^n_-$, we have
  \begin{align*}
    D^\alpha E\phi(x)
    & = \sum_{k=0}^\infty \sum_{j=0}^{\alpha_n} \binom{\alpha_n}{j}
        (-2^k)^{\alpha_n} f^{(\alpha_n-j)}(-2^k x_n) D_n^j D^{\alpha'} \phi(x',-2^kx_n) \\
    & = \sum_{k=0}^\infty \psi_k(x).
  \end{align*}
  Since $\psi_k(x)=0$ when $-x_n > 1/2^{k-1}$ it follows from \eqref{eq:5.21}
  that the above series converges absolutely and uniformly as $x_n\to 0-$.
  Hence by~\eqref{eq:5.20}
  \begin{align*}
    \lim_{x_n\to 0-} D^\alpha E\phi(x)
    & = \sum_{k=0}^{\infty} (-2^k)^{\alpha_n} a_k D^\alpha \phi(x',0+) \\
    & = D^\alpha \phi(x',0+) = \lim_{x_n\to 0+} D^\alpha E\phi(x) = D^\alpha E\phi(0).
  \end{align*}
  Thus $E\phi \in C_0^\infty(\mathbb{R}^n)$. Moreover, if $|\alpha|\leq m$,
  \[ |\psi_k(x)|^p \leq K_1^p |a_k|^p 2^{kmp}
      \sum_{|\beta|\leq m} |D^\beta \phi(x', -2^k x_n)|^p, \]
  where $K_1$ depends only on $m$, $p$, $n$, and $f$. Thus
  \begin{align*}
    \|psi_k\|_{0,p,\mathbb{R}^n_-}
    & \leq K_1 |a_k| 2^{km} \Biggl(\sum_{|\beta|\leq m} \int_{\mathbb{R}^n_-}
        |D^\beta \phi(x',-2^k x_n)|^p \d x\Biggr)^{1/p} \\
    & = K_1 |a_k| 2^{km} \Biggl(\frac{1}{2^k} \sum_{|\beta|\leq m}
        \int_{\mathbb{R}^n_+} |D^\beta \phi(y)|^p \d y\Biggr)^{1/p} \\
    & \leq K_1 |a_k| 2^{km} \|\phi\|_{m,p,\mathbb{R}^n_+}.
  \end{align*}
  It follows from~\eqref{eq:5.21} that
  \[ \|D^\alpha E\phi(x)\|_{0,p,\mathbb{R}^n_-}
      \leq K_1 \|\phi\|_{m,p,\mathbb{R}^n_+} \sum_{k=0}^\infty 2^{km} |a_k|
      \leq K_2 \|\phi\|_{m,p,\mathbb{R}^n_+}. \]
  Combining this with a similar (trivial) estimate 
  for $\|D^\alpha E\phi\|_{0,p,\mathbb{R}^n_+}$,
  we obtain
  \[ \|E\phi\|_{m,p,\mathbb{R}^n} \leq K_3 \|\phi\|_{m,p,\mathbb{R}^n_+} \]
  where $K_3 = K_3(m,p,n)$. This completes the proof.
\end{proof}


\begin{theorem}
  Let $\Omega$ be a domain in $\mathbb{R}^n$ satisfying the uniform
  $C^m$-regularity condition and having a bounded boundary. Then there
  exists a strong $m$-extension operator $E$ for $\Omega$. MOreover,
  if $\alpha$ and $\gamma$ are multi-indices with $|\gamma|\leq |\alpha|\leq m$,
  then there exists a linear operator $E_{\alpha\gamma}$ continuous
  from $W^{j,p}(\Omega)$ into $W^{j,p}(\mathbb{R}^n)$ for
  $1\leq j\leq m-|\alpha|$, $1\leq p<\infty$, such that if
  $u\in W^{|\alpha|,p}(\Omega)$, then
  \begin{equation}\label{eq:5.23}
    D^\alpha (Eu)(x) = \sum_{|\gamma|\leq |\alpha|} E_{\alpha\gamma} D^\gamma u(x).
  \end{equation}
\end{theorem}

\begin{proof}
  Since $\Omega$ is uniformly $C^m$-regular and has a bounded boundary
  the open cover $\{U_j\}$ of $\partial\Omega$ and the corresponding
  $m$-smooth maps $\Phi_j$ from $U_j$ onto $B$ referred to in Paragraph~4.10
  are finite collections, say $1\leq j\leq N$. Let
  $Q = \{y=(y',y_n)\in\mathbb{R}^n : |y'|<1/2, |y_n| < \sqrt3/2\}$. Then
  \[ \{y\in\mathbb{R}^n : |y|<1/2\} \subset Q \subset
      B = \{y\in\mathbb{R}^n : |y|<1\}. \]
  By condition (ii) of Paragraph 4.10 the open sets $V_j = \Psi_j(Q)$,
  $1\leq j\leq N$, form an open cover of $\Omega_{\delta} = \{x\in\Omega:
  \dist(x,\partial\Omega) < \delta\}$ for some $\delta>0$. There exists
  an open set $V_0\subset\Omega$, bounded away from $\partial\Omega$,
  such that $\Omega\subset\bigcup_{j=0}^N V_j$. By Theorem~3.15 we can
  find infinitely differentiable functions $\omega_0$, $\omega_1$, $\cdots$,
  $\omega_N$ such that the support of $\omega_j$ is a subset of $V_j$
  and $\sum_{j=0}^N \omega_j(x)=1$ for all $x\in\Omega$. (Note that the
  support of $\omega_0$ need not be compact if $\Omega$ is unbounded.)

  Since $\Omega$ is uniformly $C^m$-regular it satisfies the segment
  condition and so restrictions to $\Omega$ of functions in
  $C_0^\infty(\mathbb{R}^n)$ are dense in $W^{k,p}(\Omega)$.
  If $\phi\in C_0^\infty(\mathbb{R}^n)$, then for $x\in\Omega$,
  $\phi(x) = \sum_{j=0}^N \phi_j(x)$, where $\phi_j = \omega_j\cdot\phi$.

  For $j\geq 1$ and $y\in B$ let $\psi_j(y) = \phi_j\bigl(\Psi_j(y)\bigr)$.
  Then $\psi_j\in C_0^\infty(Q)$. We extend $\psi_j$ to be identically
  zero outside $Q$. With $E$ and $E_\alpha$ defined as in Theorem~5.19,
  we have $E\psi_j\in C_0^m(Q)$, $E\psi_j = \psi_j$ on $Q_+ = \{y\in Q: y_n>0\}$, and
  \[ \|E\psi\|_{k,p,Q} \leq K_1 \|\psi_j\|_{k,p,Q_+}, \qquad 0\leq k\leq m, \]
  where $K_1$ depends on $k$, $m$, and $p$. If $\theta_j(x) = E\psi_j\bigl(\Phi_j(x)\bigr)$,
  then $\theta_j \in C_0^\infty(V_j)$ and $\theta_j(x) = \phi_j(x)$ if $x\in\Omega$.
  It may be checked by induction that if $|\alpha|\leq m$, then
  \[ D^\alpha \theta_j(x) = \sum_{|\beta|\leq |\alpha|} \sum_{|\gamma|\leq |\alpha|}
      a_{j;\alpha\beta}(x) \bigl[E_{\beta} \bigl(b_{j;\beta\gamma} \cdot
      (D^\gamma \phi_j \circ \Psi_j)\bigr)\bigr] \bigl(\Phi_j(x)\bigr), \]
  where $a_{j;\alpha\beta} \in C^{m-|\alpha|} (\overline{U_j})$ and
  $b_{j;\beta\gamma} \in C^{m-|\beta|}(\overline{B})$ depend on the
  transformations $\Phi_j$ and $\Psi_j = \Phi_j^{-1}$ and satisfy
  \[ \sum_{|\beta|\leq |\alpha|} a_{j;\alpha\beta}(x)
      b_{j;\beta\gamma}\bigl(\Phi_j(x)\bigr)
      = \begin{cases}
        1 & \text{if}\ \gamma = \alpha \\
        0 & \text{otherwise}.
      \end{cases} \]
  By Theorem~3.41 we have for $k\leq m$,
  \[ \|\theta_j\|_{k,p,\mathbb{R}^n} \leq K_2 \|E\psi_j\|_{k,p,Q}
      \leq K_1K_2 \|\psi_j\|_{k,p,Q_+} \leq K_3 \|\psi_j\|_{k,p,\Omega}, \]
  where $K_3$ may be chosen to be independent of $j$. The operator $\tilde E$
  defined by
  \[ \tilde E \phi(x) = \phi_0(x) + \sum_{j=1}^N \theta_j(x) \]
  clearly satisfies $\tilde E \phi(x) = \phi(x)$ if $x\in\Omega$, and
  \begin{equation}\label{eq:5.24}
    \bigl\|\tilde E \phi\bigr\|_{k,p,\mathbb{R}^n}
    \leq \|\phi_0\|_{k,p,\Omega} + K_3 \sum_{j=1}^N \|\phi_j\|_{k,p,\Omega}
    \leq K_4 (1 + NK_3) \|\phi\|_{k,p,\Omega},
  \end{equation}
  where
  \[ K_4 = \max_{0\leq j\leq N} \max_{|\alpha|\leq m} \sup |D^{\alpha} \omega_j(x)| < \infty. \]
  Thus $\tilde E$ is a strong $m$-extension operator for $\Omega$. Also
  \[ D^{\alpha} \tilde{E} \phi(x) 
      = \sum_{|\gamma|\leq |\alpha|} (E_{\alpha\gamma}) D^{\gamma} \phi(x), \]
  where
  \[ E_{\alpha\gamma} v(x) = \sum_{j=1}^N \sum_{|\beta|\leq |\alpha|}
      a_{j;\alpha\beta}(x) \bigl[E_{\beta} \bigl(b_{j;\beta\gamma}
      \cdot (v\cdot\omega_j) \circ \Psi_j\bigr)\bigr] \bigl(\Phi_j(x)\bigr) \]
  if $\alpha\neq\gamma$, and
  \[ E_{\alpha\alpha} v(x) = (v\cdot \omega_0)(x)
      + \sum_{j=1}^N \sum_{|\beta|\leq |\alpha|}
      a_{j;\alpha\beta}(x) \bigl[E_{\beta} \bigl(b_{j;\beta\gamma}
      \cdot (v\cdot\omega_j) \circ \Psi_j\bigr)\bigr] \bigl(\Phi_j(x)\bigr). \]
  We note that if $x\in\Omega$, then $E_{\alpha\gamma} v(x) = 0$
  for $\alpha\neq\gamma$ and $E_{\alpha\alpha} v(x) = v(x)$.
  Clearly $E_{\alpha\gamma}$ is a linear operator. By the differentiable
  property of $a_{j;\alpha\beta}$ and $b_{j;\beta\gamma}$, $E_{\alpha\gamma}$
  is continuous on $W^{j,p}(\Omega)$ into $W^{j,p}(\mathbb{R}^n)$
  for $1\leq j\leq m-|\alpha|$. This completes the proof.
\end{proof}


\begin{remarks}
  \begin{enumerate}
    \item If $\Omega$ is uniformly $C^m$-regular for all $m$, and has a
      bounded boundary, then we can use the total extension operator of
      Theorem~5.21 in place of that of Theorem~5.19 in the above proof
      to obtain a total extension operator for $\Omega$.
    \item The restrition that $\partial\Omega$ be bounded was imposed in
      Theorem~5.22 so that the open cover $\{V_j\}$ would be finite. This
      finiteness was used in two places in the proof, first in asserting
      the existence of the constant $K_4$, and secondly in obtaining the
      last inequality in~\eqref{eq:5.24}. This latter use is, however, not
      essential for the proof because~\eqref{eq:5.24} could still be
      obtained from the finite intersection property (condition (i) in
      Paragraph~4.10) even if the cover $\{V_j\}$ were not finite.
      Theorem~5.22 extends to any suitably regular domain for which there
      exists a partition of unity $\{\omega_j\}$ subordinate to $\{V_j\}$
      with $D^{\alpha} \omega_j$ bounded on $\mathbb{R}^n$ uniformly in $j$
      for any given $\alpha$. The reader may find it interesting to construct,
      by the above techniques, extension operators for domains not covered
      by the above theorems, for example, quadrants, strips, rectangular boxes,
      and smooth images of these.
    \item The previous remark also applies to the Calder\'on Extension Theorem~5.28
      given below. Although it is proved by methods quite different from the
      reflection methods used above, the proof still makes use of a partition
      of unity in the same way as does that of Theorem~5.22. Accordingly,
      the above considerations also apply to it. The theorem is proved under
      a strengthened uniform cone condition that reduces to the uniform cone
      condition of Paragraph~4.8 if $\Omega$ has a bounded boundary.
  \end{enumerate}
\end{remarks}

Clearly subsuming the extension theorems obtained above is the following
theorem of Stein [St].

\begin{theorem}[The Stein Extension THeorem]
  If $\Omega$ is a domain in $\mathbb{R}^n$ satisfying the strong
  local Lipschitz condition, then there exists a total extension operator
  for $\Omega$.
\end{theorem}

We will provide here only an outline of the proof. The details can be found
in Chapter~6 of [St].

\begin{para}[Outline of the Proof of the Stein Extension Theorem]
  \begin{enumerate}
    \item Let $\Omega_e = \mathbb{R}^n - \overline{\Omega}$ be the open
      operator of $\Omega$. The function $\delta(x) = \dist(x, \overline{\Omega})$
      is Lipschitz continuous on $\Omega_e$ since
      \[ |\delta(x) - \delta(y)| \leq |x-y| \quad \text{for} \ x,y\in\Omega_e, \]
      but might not be smooth there. However, there exists a function
      $\Delta$ in $C^{\infty}(\Omega_e)$ and positive constants $c_1$, $c_2$,
      and $C_{\alpha}$ for all multiindices $\alpha$ such that for all $x\in\Omega_e$,
      \begin{align*}
        & c_1 \delta(x) \leq \Delta(x) \leq c_2 \delta(x), \qquad \text{and} \\
        & |D^{\alpha} \Delta(x)| \leq C_{\alpha} \bigl(\delta(x)\bigr)^{1-|\alpha|}.
      \end{align*}
    \item There exists a continuous function $\phi$ on $[1,\infty)$ for which
      \begin{enumerate}[(a)]
        \item $\lim_{t\to\infty} t^k \phi(t) = 0$ for $k=0,1,2,\ldots$,
        \item $\int_1^{\infty} \phi(t) \d t = 1$,
        \item $\int_1^{\infty} t^k \phi(t) = 0$ for $k=1,2,\ldots$.
      \end{enumerate}
      In fact, $\phi(t) = \frac{e}{\pi t} \Im\bigl(e^{-w(t-1)^{1/4}}\bigr)$,
      where $w = e^{-i\pi/4}$, is such a function.
    \item For the special case $\Omega = \{(x,y) : x\in\mathbb{R}^{n-1}, y\in\mathbb{R},
      y > f(x)\}$ where $f$ satisfies a Lipschitz condition
      $|\phi(x) - \phi(x')|\leq M|x-x'|$, there exists a constant $c$
      such that if $(x,y)\in\Omega_e$, then $\phi(x)-y \leq c\Delta(x,y)$.
    \item For $\Omega$ as specified in 3, $\Delta^*(x,y) = 2c\Delta(x,y)$,
      and $u\in C_0^\infty(\mathbb{R}^n)$, the operator $E$ defined by
      \[E(u)(x,y) = 
        \begin{cases}
          u(x,y) & \text{if}\ y>f(x) \\
          \int_1^\infty u\bigl(x, y+t\Delta^*(x,y)\bigr) \phi(t) \d t & \text{if}\ y<f(x)
        \end{cases}\]
      satisfies, for every $m\geq 0$ and $1\leq p\leq\infty$,
      \begin{equation}\label{eq:5.25}
        \|E(u)\|_{m,p,\mathbb{R}^n} \leq K \|u\|_{m,p,\Omega}, 
      \end{equation}
      where $K = K(m,p,n,M)$. Since $\Omega$ satisfies the strong local
      Lipschitz condition it also satisfies the segment condition and so,
      by Theorem~3.22 the restrictions to $\Omega$ of functions in $C_0^\infty(\mathbb{R}^n)$
      are dense in $W^{m,p}(\Omega)$ and so~\eqref{eq:5.25} holds for all
      $u\in W^{m,p}(\Omega)$. Thus Stein's theorem holds for this $\Omega$.
    \item The case of general $\Omega$ satisfying the strong local Lipschitz
      condition now follows via a partition of unity subordinate to an open
      cover of $\partial\Omega$ by open sets in each of which (a rotated version
      of) the special case 4 can be applied.
  \end{enumerate}
\end{para}


\begin{para}
  The proof of the Calder\'on extension theorem is based on a special case,
  suitable for our purposes, of a well-known inequality of Calder\'on and
  Zygmund [CZ] for convolutions involving kernels with nonintegrable
  singularities. The proof of this inequality is rather lengthy and can be found
  in many sources (e.g.~Stein and Weiss [SW]). It will be omitted here.
  Neither the inequality nor the extension theorem itself will be required
  hereafter in this monograph.

  Let $B_R = \{x\in\mathbb{R}^n : |x|\leq R\}$,
  let $\Sigma_R = \{x\in\mathbb{R}^n : |x|=R\}$, and let $\d\sigma_R$ be the area
  element (Lebesgue $(n-1)$-volume element) on $\Sigma_R$. A function $g$
  is said to be \emph{homogeneous of degree $\mu$} on $B_R - \{0\}$
  if $g(tx) = t^\nu g(t)$ for all $x\in B_R - \{0\}$ and $0<t\leq 1$.
\end{para}


\begin{theorem}[The Calder\'on Zygmund Inequality]
  Let
  \[ g(x) = G(x) |x|^{-n}, \]
  where
  \begin{enumerate}[(i)]
    \item $G$ is bounded on $\mathbb{R}^n-\{0\}$ and has compact support,
    \item $G$ is homogeneous of degree 0 on $B_R-\{0\}$ for some $R>0$, and
    \item $\int_{\Sigma_R} G(x) \d\sigma_R = 0$.
  \end{enumerate}
  If $1<p<\infty$ and $u\in L^p(\mathbb{R}^n)$, then the principal-value
  convolution integral
  \[ u*g(x) = \lim_{\epsilon\to 0+} \int_{\mathbb{R}^n - B_{\epsilon}}
      u(x-y) g(y) \d y \]
  exists for almost all $x\in\mathbb{R}^n$, and there exists a constant
  $K=K(G,p)$ such that for all such $u$
  \[ \|u*g\|_p \leq K\|u\|_p. \]
  Conversely, if $G$ satisfies (i) and (ii) and if $u*g$ exists for all
  $u\in C_0^{\infty}(\mathbb{R}^n)$, then $G$ satisfies (iii).
\end{theorem}


\begin{theorem}[The Calder\'on Extension Theorem]
  Let $\Omega$ be a domain in $\mathbb{R}^n$ satisfying the uniform cone
  condition (Paragraph 4.8) modified as follows:
  \begin{enumerate}[(i)]
    \item the open cover $\{U_j\}$ of $\partial\Omega$ is required to be finite, and
    \item the sets $\{U_j\}$ are not required to be bounded.
  \end{enumerate}
  Then for any $m\in\{1,2,\ldots\}$ and any $p$ satisfying $1<p<\infty$,
  there exists a simple $(m,p)$-extension operator $E=E(m,p)$ for $\Omega$.
\end{theorem}

\begin{proof}
  Let $\{U_1,\ldots,U_N\}$ be the open cover of $\partial\Omega$
  given by the uniform cone condition, and let $U_0$ be an open subset
  of $\Omega$ bounded away from $\partial\Omega$ such that
  $\Omega\subset\bigcup_{j=0}^N U_j$. (Such a $U_0$ exists by condition (ii)
  of Paragraph 4.8.) Let $\omega_0$, $\omega_1$, $\ldots$, $\omega_N$
  be a $C^{\infty}$ partition of unity for $\Omega$ with $\supp(\omega)_j\subset U_j$.
  For $1\leq j\leq N$ we shall define operators $E_j$ so that if
  $u\in W^{m,p}(\Omega)$, then $E_j u\in W^{m,p}(\mathbb{R}^n)$ and satisfies
  \begin{align*}
    & E_j u = u \qquad \text{in}\ U_j\cap\Omega, \\
    & \|E_j u\|_{m,p,\mathbb{R}^n} \leq K_{m,p,j} \|u\|_{m,p,\Omega}.
  \end{align*}
  The desired extension operator is then clearly given by
  \[ Eu = \omega_0 u + \sum_{j=1}^N \omega_j E_j u. \]
  We shall write $x\in \mathbb{R}^n$ in the polar coordinate form
  $x = \rho\sigma$ where $\rho\geq 0$ and $\sigma$ is a unit vector.
  Let $C_j$, the cone associated with $U_j$ in the description of the
  uniform cone condition. have vertex at 0. Let $\phi_j$ be a nontrivial
  function defined in $\mathbb{R}^n - \{0\}$ satisfying
  \begin{enumerate}[(i)]
    \item $\phi_j(x)\geq 0$ for all $x\neq 0$,
    \item $\supp(\phi_j) \subset -C_j\cup\{0\}$,
    \item $\phi_j\in C^{\infty}(\mathbb{R}^n - \{0\})$, and
    \item for some $\epsilon>0$, $\phi_j$ is homogeneous of degree $m-n$ in $B_{\epsilon}-\{0\}$.
  \end{enumerate}
  Now $\rho^{n-1} \phi_j$ is homogeneous of degree $m-1\geq 0$
  on $B_{\epsilon}-\{0\}$ and so the function $\psi_j(x) = 
  (\partial/\partial\rho)^m \bigl(\rho^{n-1} \phi_j(x)\bigr)$
  vanishes on $B_{\epsilon} - \{0\}$. Hence $\psi_j$, extended to be
  zero at $x=0$, belongs to $C_0^\infty(-C_j)$. Define
  \begin{equation}\label{eq:5.26}
    \begin{aligned}
      E_j u(y) ={}
      & K_j \biggl((-1)^m \int_{\Sigma} \int_0^{\infty} \phi_j(\rho\sigma)
        \rho^{n-1} \biggl(\frac{\partial}{\partial\rho}\biggr)^m
        \tilde{u}(y-\rho\sigma) \d\rho\d\sigma \\
      & - \int_{\Sigma} \int_0^{\infty} \psi_j(\rho\sigma)
        \tilde{u}(y-\rho\sigma) \d\rho\d\sigma\biggr)
    \end{aligned}
  \end{equation}
  where $\tilde{u}$ is the zero extension of $u$ outside $\Omega$
  and where the constant $K_j$ will be determined shortly.
  If $y\in U_j\cap\Omega$, then, assuming for the moment that
  $u\in C^{\infty}(\Omega)$, we have, for $\rho\sigma\in\supp(\phi_j)$,
  by condition (iii) of Paragraph~4.8, that $\tilde{u}(y-\rho\sigma) = u(y-\rho\sigma)$
  is infinitely differentiable. Now integration by parts $m$ times yields
  \begin{align*}
    (-1)^m
    & \int_0^\infty \rho^{n-1} \phi_j(\rho\sigma) \biggl(\frac{\partial}{\partial\rho}\biggr)
      u(y-\rho\sigma) \d\rho \\
    & = \sum_{k=0}^{m-1} (-1)^{m-k} \biggl(\frac{\partial}{\partial\rho}\biggr)^k
      \bigl(\rho^{n-1} \phi_j(\rho\sigma)\bigr)
      \biggl(\frac{\partial}{\partial\rho}\biggr)^{m-k-1} u(y-\rho\sigma)
      \bigg|_{\rho=0}^{\rho=\infty} \\
    & \quad + \int_0^\infty \biggl(\frac{\partial}{\partial\rho}\biggr)^m
      \bigl(\rho^{n-1} \phi_j(\rho\sigma)\bigr) u(y-\rho\sigma) \d\rho \\
    & = \biggl(\frac{\partial}{\partial\rho}\biggr)^{m-1}
      \bigl(\rho^{n-1} \phi_j(\rho\sigma)\bigr)\Big|_{\rho=0} u(y)
      + \int_0^\infty \psi_j(\rho\sigma) u(y-\rho\sigma) \d\rho.
  \end{align*}
  Hence
  \[ E_j u(y) = K_j u(y) \int_{\Sigma} \biggl(\frac{\partial}{\partial\rho}\biggr)^{m-1}
      \bigl(\rho^{n-1} \phi_j(\rho\sigma)\bigr)\Big|_{\rho=0} \d\sigma. \]
  Since $(\partial/\partial\rho)^{m-1} \bigl(\rho^{n-1} \phi_j(\rho\sigma)\bigr)$
  is homogeneous of degree zero near 0, the above integral does not vanish
  if $\phi_j$ is not identically zero. Hence $K_j$ can be chosen
  so that $E_j u(y) = u(y)$ for $y\in U_j\cap\Omega$ and all $u\in C^\infty(\Omega)$.
  Since $C^\infty(\Omega)$ is dense in $W^{m,p}(\Omega)$ we have
  $E_j u(y) = u(y)$ a.e.~in $U_j\cap\Omega$ for every $u\in W^{m,p}(\Omega)$.
  The same argument shows that if $\tilde{u}\in W^{m,p}(\mathbb{R}^n)$,
  then $E_j u(y) = \tilde{u}(y)$ a.e.~in $\mathbb{R}^n$.

  It remains, therefore, to show that
  \[ \|D^\alpha E_j u\|_{0,p,\mathbb{R}^n} \leq K_{\alpha} \|u\|_{m,p,\Omega} \]
  holds for any $\alpha$ with $|\alpha|\leq m$ and all
  $u\in C^\infty(\Omega)\cap W^{m,p}(\Omega)$. The last integral in~\eqref{eq:5.26}
  is of the form $\theta_j * \tilde u(y)$, where $\theta_j(x) = \psi_j(x)|x|^{1-n}$.
  Since $\theta_j\in L^1(\mathbb{R}^n)$ and has compact support, we obtain via
  Young's inequality for convolution (Corollary~2.25),
  \[ \|D^{\alpha} (\theta_j * \tilde u)\|_{0,p,\mathbb{R}^n}
      = \|\theta_j * \widetilde{D^{\alpha} u} \|_{0,p,\mathbb{R}^n}
      \leq \|\theta_j\|_{0,1,\mathbb{R}^n} \|D^{\alpha} u\|_{0,p,\Omega}. \]
  It now remains to be shown that the first integral in~\eqref{eq:5.26}
  defines a bounded map from $W^{m,p}(\Omega)$ into $W^{m,p}(\mathbb{R}^n)$.
  Since $(\partial/\partial\rho)^m = \sum_{|\alpha|=m} (m!/\alpha!)\sigma^{\alpha} D^{\alpha}$
  we obtain
  \begin{align*}
    \int_{\Sigma} \int_0^\infty
    & \phi_j (\rho\sigma) \rho^{n-1} \biggl(\frac{\partial}{\partial\rho}\biggr)^m
      \tilde{u}(y-\rho\sigma) \d\rho \d\sigma \\
    & = \sum_{|\alpha|=m} \frac{m!}{\alpha!} \int_{\mathbb{R}^n}
      \phi_j(x) \widetilde{D_x^{\alpha}} u(y-x) \sigma^{\alpha} \d x \\
    & = \sum_{|\alpha|=m} \xi_{\alpha} * \widetilde{D^{\alpha} u},
  \end{align*}
  where $\xi_{\alpha} = (-1)^{|\alpha|} (m!/\alpha!)\sigma^{\alpha} \phi_j$
  is homogeneous of degree $m-n$ in $B_{\epsilon} - \{0\}$ and belongs
  to $C^{\infty}(\mathbb{R}^n - \{0\})$. It is now clearly sufficient
  to show that for any $\beta$ satisfying $|\beta|\leq m$
  \begin{equation}\label{eq:5.27}
    \|D^{\beta} (\xi_{\alpha} * v)\|_{0,p,\mathbb{R}^n}
    \leq K_{\alpha,\beta} \|v\|_{0,p,\mathbb{R}^n}.
  \end{equation}
  If $|\beta|\leq m-1$, then $D^{\beta} \xi_{\alpha}$ is homogeneous
  of degree not exceeding $1-n$ in $B_{\epsilon} - \{0\}$ and so belongs
  to $L^1(\mathbb{R}^n)$. Inequality~\eqref{eq:5.27} now follows by
  Young's inequality for convolution. Thus we need consider only the case
  $|\beta|=m$, in which we write $D^{\beta} = (\partial/\partial x_i) D^{\gamma}$
  for some $i$, $1\leq i\leq n$, and some $\gamma$ with $|\gamma|=m-1$.
  Suppose, for the moment, that $v\in C_0^{\infty}(\mathbb{R}^n)$.
  Then we may write
  \begin{align*}
    D^{\beta} (\xi_{\alpha} * v)(x)
    & = (D^{\gamma} \xi_{\alpha}) * \biggl[\biggl(\frac{\partial}{\partial x_i}\biggr)v\biggr](x)
      = \int_{\mathbb{R}^n} D_i v(x-y) D^{\gamma} \xi_{\alpha}(y) \d y \\
    & = \lim_{\delta\to 0+} \int_{\mathbb{R}^n - B_{\delta}} D_i v(x-y)
        D^{\gamma} \xi_{\alpha}(y) \d y.
  \end{align*}
  We now integrate by parts in the last integral to free $v$ and obtain
  $D^{\beta} \xi_{\alpha}$ under the integral. The integrated term is a
  surface integral over the spherical boundary $\Sigma_\delta$ of $B_\delta$
  of the product of $v(x-\cdot)$ and a function homogeneous of degree $1-n$
  near zero. This surface integral must therefore tend to $Kv(x)$
  as $\delta\to 0+$, for some constant $K$. Noting that
  $D_i v(x-y) = -(\partial/\partial y_i) v(x-y)$, we now have
  \[ D^{\beta} (\xi_{\alpha} * v)(x)
      = \lim_{\delta\to 0+} \int_{\mathbb{R}^n} v(x-y) D^{\beta} \xi_{\alpha}(y) \d y
      + Kv(x). \]
  Now $D^\beta \xi_\alpha$ is homogeneous of degree $-n$ near the origin and so,
  by the last assertion of Theorem~5.27, $D^\beta \xi_\alpha$ satisfies all
  the conditions for the singular kernel $g$ of that theorem. Since $1<p<\infty$,
  we have for any $v\in L^p(\Omega)$ (regarded as being identically zero
  outside $\Omega$)
  \[ \|D^\beta \xi_\alpha * v\|_{0,p,\mathbb{R}^n}
      \leq K_{\alpha,\beta} \|v\|_{0,p,\mathbb{R}^n}. \]
  This completes the proof.
\end{proof}


As observed in the proof of the above theorem, the Calder\'on extension
of a function $u\in W^{m,p}(\Omega)$ coincides with the zero extension
$\tilde u$ of $u$ if $\tilde u$ belongs to $W^{m,p}(\mathbb{R}^n)$.
The following theorem (which could have been proven in Chapter~3)
shows that in this case $u$ must belong to $W_0^{m,p}(\Omega)$.


\begin{theorem}[Characterization of $W_0^{m,p}(\Omega)$ by Exterior Extension]
  Let $\Omega$ have the segment property. Then a function $u$ on $\Omega$
  belongs to $W_0^{m,p}(\Omega)$ if and only if the zero extension $\tilde u$
  of $u$ belongs to $W^{m,p}(\mathbb{R}^n)$.
\end{theorem}

\begin{proof}
  Lemma 3.27 shows, with no hypotheses on $\Omega$, that if $u\in W_0^{m,p}(\Omega)$,
  then $\tilde u\in W^{m,p}(\mathbb{R}^n)$.

  Conversely, suppose that $\Omega$ has the segment property and that
  $\tilde u\in W^{m,p}(\mathbb{R}^n)$. Proceed as in the proof of Theorem~3.22,
  first multiplying $u$ by a suitable smooth cutoff function $f_{\epsilon}$
  to approximate $u$ in $W^{m,p}(\Omega)$ by a function in that space
  with a bounded support. Replace $u$ by that approximation; then $\tilde u$
  is replaced by $f_{\epsilon} \tilde{u}$, and so still belongs to
  $W^{m,p}(\mathbb{R}^n)$. Now split this $u$ into finitely many pieces $u_j$,
  where $0\leq l\leq k$, with $u_j$ supported in a set $V_j$ and the union
  of the sets $V_j$ covering the support of $u$. In the context of that
  theorem, $u_0$ already belongs to $W_0^{m,p}(\Omega)$.

  For the other values of $j$, use a translate $u_{j,t}$ of $\tilde u$
  mapping $x$ to $\tilde{u_j}(x-ty)$ rather than to $\tilde{u_j}(x+ty)$
  as we did in the proof of Theorem~3.22. For small enough positive values
  of $t$, using $x-ty$ shifts the support of $\tilde{u_j}$ strictly
  inside the domain $\Omega$. Then $u_{j,t}$ belongs to $W^{m,p}(\mathbb{R}^n)$
  since $\tilde{u_j}$ does. Since $u_{j,t}$ vanished outside a compact subset
  of $\Omega$, the restriction of $u_{j,t}$ to $\Omega$ belongs to
  $W^{m,p}_0(\Omega)$. As $t\to 0+$, these restrictions converge to $u_j$
  in $W^{m,p}(\Omega)$. Thus each piece $u_j$ belongs to $W_0^{m,p}(\Omega)$,
  and so does $u$.
\end{proof}


\begin{para}
  There is a close connection between the existence of extension operators
  and imbeddings into spaces of H\"older continuous functions. For example,
  it is shown in [Ko] that the imbedding $W^{m,p}(\Omega) \to
  C^{0,1-(n/p)}(\overline{\Omega})$ implies the existence of a simple
  $(1,q)$-extension operator for $\Omega$ provided $q>p$.
\end{para}


\section{An Approximation Theorem}

\begin{para}[The Approximation Property]
  The following question is involved in the matter of interpolation of
  Sobolev spaces on order of smoothness that will play a central role
  in the development of Besov spaces and Sobolev spaces of fractional
  order in Chapter~7.

  \begin{quotation}
    If $0<k<m$ does there exist a constant $C$ such that for every
    $u\in W^{k,p}(\Omega)$ and every sufficiently small $\epsilon$
    there exists $u_{\epsilon}\in W^{m,p}(\Omega)$ satisfying
    \[ \|u-u_{\epsilon}\|_p \leq C\epsilon^k \|u\|_{k,p},
        \qquad \text{and} \qquad
        \|u_{\epsilon}\|_{m,p} \leq C\epsilon^{k-m} \|u\|_{k,p}? \]
  \end{quotation}
  If the answer is ``yes'', we will say that the domain $\Omega$
  has the \emph{approximation property}. Combined with the interpolation
  Theorem~5.2, this property will show that $W^{k,p}(\Omega)$ is suitably
  intermediate between $L^p(\Omega)$ and $W^{m,p}(\Omega)$ for purposes
  of interpolation. In Theorem~5.33 we prove that $\mathbb{R}^n$ itself
  has the approximation property. It will therefore follow that any
  domain $\Omega$ admitting a total extension operator will have the
  approximation property for any choice of $k$ and $m$ with conditions
  has the approximation property.

  There are domains with the approximation property that do not satisfy
  the strong local Lipschitz condition. The approximation property does
  not prevent a domain from lying on both sides of a boundary hypersurface.
  In [AF4] the authors obtain the property under the assumption that
  $\Omega$ satisfies the ``smooth cone condition'', which is essentially
  a cone condition with the added restriction that the cone must
  vary smoothly from point to point. Our proof of Theorem~5.33 is a
  simplified version of the proof in [AF4].

  We begin by stating an elementary lemma.
\end{para}


\begin{lemma}
  If $u\in L^p(\mathbb{R}^n)$ and $B_{\epsilon}(x)$ is the ball
  of radius $\epsilon$ about $x$, then
  \[ \int_{\mathbb{R}^n} \biggl(\int_{B_{\epsilon}(x)} |u(y)| \d y\biggr)^p \d x
      \leq K_n^p \epsilon^{np} \|u\|_{p,\mathbb{R}^n}^p, \]
  where $K_n$ is the volume of the unit ball $B_1(0)$.
\end{lemma}

\begin{proof}
  The proof is immediate using H\"older's inequality and a change or
  order of integration.
\end{proof}


\begin{theorem}[An Approximation Theorem for $\mathbb{R}^n$]
  If $0<k<m$, there exists a constant $C$ such that for $u\in W^{k,p}(\mathbb{R}^n)$
  and $0<\epsilon\leq 1$ there exists $u_{\epsilon}$ in $C^{\infty}(\mathbb{R}^n)$
  such that the following seminorm inequalities hold:
  \begin{align*}
    & \|u-u_{\epsilon}\|_p \leq C\epsilon^k |u|_{k,p}, \qquad\text{and} \\
    & |u_{\epsilon}|_{j,p} \leq
      \begin{cases}
        C \|u\|_{k,p} & \text{if } j\leq k-1 \\
        C \epsilon^{k-j} |u|_{k,p} & \text{if } j\geq k.
      \end{cases}
  \end{align*}
  In particular, $\mathbb{R}^n$ has the approximation property.
\end{theorem}

\begin{proof}
  It is sufficient to establish the inequalities for $u\in C_0^\infty(\mathbb{R}^n)$
  which is dense in $W^{k,p}(\mathbb{R}^n)$. We apply Taylor's formula
  \[ f(1) = \sum_{j=0}^{k-1} \frac{1}{j!} f^{(j)}(0)
      + \frac{1}{(k-1)!} \int_0^1 (1-t)^{k-1} f^{(k)}(t) \d t \]
  to the function $f(t) = u\bigl(tx+(1-t)y\bigr)$ to obtain
  \begin{align*}
    u(x) ={}
    & \sum_{|\alpha|\leq k-1} \frac{1}{\alpha!} D^\alpha u(y) (x-y)^\alpha \\
    & + \sum_{|\alpha|=k} \frac{k}{\alpha!} (x-y)^\alpha
        \int_0^1 (1-t)^{k-1} D^\alpha u\bigl(tx+(1-t)y\bigr) \d t.
  \end{align*}
  Now let $\phi\in C_0^\infty(B_1(0))$ satisfy $0\leq\phi(x)\leq K_0$
  for all $x$ and $\int_{\mathbb{R}^n} \phi(x) \d x=1$. We multiply
  the above Taylor formula by $\epsilon^{-n} \phi\bigl((x-y)/\epsilon\bigr)$
  and integrate $y$ over $\mathbb{R}^n$ to obtain $u(x) = u_{\epsilon}(x) + R(x)$
  where
  \begin{align*}
    u_{\epsilon}(x)
    & = \epsilon^{-n} \sum_{|\alpha|\leq k-1} \frac{1}{\alpha!}
        \int_{\mathbb{R}^n} \phi\biggl(\frac{x-y}{\epsilon}\biggr) (x-y)^\alpha
          D^\alpha u(y) \d y \\
    R(x)
    & = \epsilon^{-n} \sum_{|\alpha|=k} \frac{k}{\alpha!}
        \int_{\mathbb{R}^n} \phi\biggl(\frac{x-y}{\epsilon}\biggr) (x-y)^\alpha \d y \\
    &   \qquad \times \int_0^1 (1-t)^{k-1} D^\alpha u\bigl(tx+(1-t)y\bigr) \d t.
  \end{align*}
  We can estimate $|u(x)-u_{\epsilon}(x)| = |R(x)|$ by reversing the order
  of the double integral, substituting $z = tx+(1-t)y$ (so that $z-x = (1-t)(y-x)$
  and $\d z = (1-t)^n \d y$), and reversing the order of integration again:
  \begin{align*}
    |u(x) - u_{\epsilon}(x)|
    & \leq K_0 \sum_{|\alpha|=k} \frac{k}{\alpha!} \epsilon^{-n}
        \int_0^1 (1-t)^{-1-n} \d t \int_{B_{\epsilon(1-t)}(x)} |x-z|^k |D^\alpha u(z)| \d z \\
    & \leq K_0 \sum_{|\alpha|=k} \frac{k}{\alpha!} \epsilon^{-n}
        \int_{B_{\epsilon}(x)} |x-z|^k |D^\alpha u(z)| \d z
        \int_0^{1-|z-x|/\epsilon} (1-t)^{-n-1} \d t \\
    & < K_0 \sum_{|\alpha|=k} \frac{k}{\alpha!} \epsilon^{-n}
        \int_{B_{\epsilon}(x)} |x-z|^k |D^\alpha u(z)| \d z \\
    & \leq K_0 \sum_{|\alpha|=k} \frac{k}{\alpha!} \epsilon^{k-n}
        \int_{B_{\epsilon}(x)} |D^\alpha u(z)| \d z.
  \end{align*}
  Estimating the $L^p$-norm of the last integral above by the previous lemma,
  we obtain
  \[ \|u(x)-u_{\epsilon}(x)\|_p
      \leq K_0 \sum_{|\alpha|=k} \frac{k}{\alpha!} \epsilon^k \|D^\alpha u\|_p
      \leq C \epsilon^k |u|_{k,p}. \]
  On the other hand, we have
  \[ u_{\epsilon}(x) = \epsilon^{-n} \int_{\mathbb{R}^n}
      \phi\biggl(\frac{x-y}{\epsilon}\biggr) P_{k-1}(u;x,y) \d y, \]
  where
  \begin{align*}
    P_j(u;x;y) & = \sum_{i=0}^j T_i(u;x,y), \\
    T_j(u;x,y) & = \sum_{|\alpha|=j} \frac{1}{\alpha!} D^\alpha u(y) (x-y)^\alpha.
  \end{align*}
  It is readily verified that
  \begin{align*}
    \frac{\partial}{\partial x_i} T_j(u;x,y)
    & = \begin{cases}
          T_{j-1}(D_i u;x,y) & \text{if } j>0 \\
          0 & \text{if } j=0
        \end{cases} \\
    \frac{\partial}{\partial x_i} P_j(u;x,y)
    & = \begin{cases}
          P_{j-1}(D_i u;x,y) & \text{if } j>0 \\
          0 & \text{if } j=0
        \end{cases} \\
    \frac{\partial}{\partial y_i} P_j(u;x,y)
    & = T_j(D_i u;x,y) \qquad \text{for } j\geq 0.
  \end{align*}
  Since $\frac{\partial}{\partial x_i}\phi\bigl(\frac{x-y}{\epsilon}\bigr)
  = - \frac{\partial}{\partial y_i}\phi\bigl(\frac{x-y}{\epsilon}\bigr)$,
  integration by parts gives
  \begin{align*}
    D_i u_{\epsilon}(x) ={}
    & \epsilon^{-n} \int_{\mathbb{R}^n} \phi\biggl(\frac{x-y}{\epsilon}\biggr)
      P_{k-2}(D_i u;x,y) \d y \\
    & + \int_{\mathbb{R}^n} \phi\biggl(\frac{x-y}{\epsilon}\biggr)
        T_{k-1}(D_i u;x,y) \d y.
  \end{align*}
  By induction, if $|\beta|=j\leq k$,
  \begin{align*}
    D^\beta u_\epsilon(x) ={}
    & \epsilon^{-n} \int_{\mathbb{R}^n} \phi\biggl(\frac{x-y}{\epsilon}\biggr)
      P_{k-1-j}(D^\beta u;x,y) \d y \\
    & + j \epsilon^{-n} \int_{\mathbb{R}^n} \phi\biggl(\frac{x-y}{\epsilon}\biggr)
        T_{k-j}(D^\beta u;x,y) \d y.
  \end{align*}
  When $j=k$ the sums $P_{k-1-j}$ are empty, leaving only the second
  line above, which becomes
  \[ k\epsilon^{-n} \int_{\mathbb{R}^n} \phi\biggl(\frac{x-y}{\epsilon}\biggr)
      T_0(D^\beta u;x,y) \d y
      = k\epsilon^{-n} \int_{\mathbb{R}^n} \phi\biggl(\frac{x-y}{\epsilon}\biggr)
        D^\beta u(y) \d y. \]
  Write any multi-index $\gamma$ with $|\gamma|>k$ in the form $\beta+\delta$
  with $|\beta|=k$ to get that
  \[ D^{\gamma} u_{\epsilon}(x) = k\epsilon^{-n-|\delta|}
      \int_{\mathbb{R}^n} D^{\delta} \phi\biggl(\frac{x-y}{\epsilon}\biggr)
      D^{\beta} u(y) \d y \]
  in these cases. Apply the previous lemma to the various terms above to get that
  \[ |u_{\epsilon}|_{j,p} \leq
      \begin{cases}
        C \|u\|_p & \text{if } j\leq k-1 \\
        C \epsilon^{k-j} |u|_{k,p} & \text{if } j\geq k.
      \end{cases}\]
  In deriving this when $j<k$, expand the (nonempty) sums $P_{k-1-j}$
  to see that
  \[ |D^{\beta} u_{\epsilon}(x) \leq K_0 \epsilon^{-n}
      \int_{B_{\epsilon}(x)} \Biggl[\sum_{i=0}^{k-1-j} |T_i(D^\beta u;x,y)
        + j |T_{k-j}(D^\beta u;x,y)|\Biggr] \d y. \]
  This completes the proof.
\end{proof}


\section{Boundary Traces}

\begin{para}
  Of importance in the study of boundary value problems for differential
  operators defined on a domain $\Omega$ is the determination of spaces
  of functions defined on the boundary of $\Omega$ that contain the
  traces $u|_{\partial\Omega}$ of functions $u$ in $W^{m,p}(\Omega)$.
  For example, if $W^{m,p}(\Omega) \to C^0(\overline{\Omega})$, then
  clearly $u|_{\partial\Omega}$ belongs to $C(\partial\Omega)$. We outline
  below an $L^q$-imbedding result for such traces which can be obtained
  for domains with suitably smooth boundaries as a corollary of Theorem~4.12
  via the use of an extension operator.

  The more interesting problem of characterizing the image of $W^{m,p}(\Omega)$
  under the mapping $u \mapsto u|_{\partial\Omega}$ will be dealt with in
  Chapter~7. See, in particular, Theorem~7.39. The characterization is
  in terms of Besov spaces which are generalized Sobolev spaces of fractional
  order.
\end{para}

\begin{para}
  Let $\Omega$ be a domain in $\mathbb{R}^n$ satisfying the uniform $C^m$-regularity
  condition of Paragraph~4.10. Thus there exists a locally finite open cover
  $\{U_j\}$ of $\partial\Omega$, and corresponding $m$-smooth transformations
  $\Psi_j$ mapping $B = \{y\in \mathbb{R}^n : |y|<1\}$ onto $U_j$ such that
  $U_j\cap \partial\Omega = \Psi_j(B_0)$, where $B_0 = \{y\in B : y_n = 0\}$.
  If $f$ is a function having support in $U_j$, we may define the integral
  of $f$ over $\partial\Omega$ via
  \[ \int_{\partial\Omega} f(x) \d\sigma
      = \int_{U_j\cap\partial\Omega} f(x) \d\sigma
      = \int_{B_0} f\circ \Psi_j(y',0) J_j(y') \d y', \]
\end{para}